<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="14.1 Measurement error | Notes for Statistical Rethinking 2nd ed. by Richard McElreath" />
<meta property="og:type" content="book" />






<meta name="date" content="2021-12-04" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="14.1 Measurement error | Notes for Statistical Rethinking 2nd ed. by Richard McElreath">

<title>14.1 Measurement error | Notes for Statistical Rethinking 2nd ed. by Richard McElreath</title>

<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#index">Index</a></li>
<li><a href="1-the-golem-of-prague.html#the-golem-of-prague"><span class="toc-section-number">1</span> The Golem of Prague</a></li>
<li class="has-sub"><a href="2-small-worlds-and-large-worlds.html#small-worlds-and-large-worlds"><span class="toc-section-number">2</span> Small Worlds and Large Worlds</a>
<ul>
<li><a href="2.1-the-garden-of-forking-data.html#the-garden-of-forking-data"><span class="toc-section-number">2.1</span> The garden of forking data</a></li>
<li><a href="2.2-building-a-model.html#building-a-model"><span class="toc-section-number">2.2</span> Building a model</a></li>
<li><a href="2.3-components-of-the-model.html#components-of-the-model"><span class="toc-section-number">2.3</span> Components of the model</a></li>
<li class="has-sub"><a href="2.4-making-the-model-go.html#making-the-model-go"><span class="toc-section-number">2.4</span> Making the model go</a>
<ul>
<li><a href="2.4-making-the-model-go.html#markov-chain-monte-carlo"><span class="toc-section-number">2.4.1</span> Markov chain Monte Carlo</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="3-sampling-from-the-imaginary.html#sampling-from-the-imaginary"><span class="toc-section-number">3</span> Sampling from the Imaginary</a>
<ul>
<li><a href="3.1-sampling-from-a-grid-approximate-posterior.html#sampling-from-a-grid-approximate-posterior"><span class="toc-section-number">3.1</span> Sampling from a grid-approximate posterior</a></li>
<li><a href="3.2-sampling-to-summarize.html#sampling-to-summarize"><span class="toc-section-number">3.2</span> Sampling to summarize</a></li>
<li><a href="3.3-sampling-to-simulate-prediction.html#sampling-to-simulate-prediction"><span class="toc-section-number">3.3</span> Sampling to simulate prediction</a></li>
<li><a href="3.4-lets-practice-with-brms.html#lets-practice-with-brms"><span class="toc-section-number">3.4</span> Let’s practice with brms</a></li>
<li><a href="practice.html#practice">Practice</a></li>
<li><a href="homework-week-1.html#homework-week-1">Homework: week 1</a></li>
</ul></li>
<li class="has-sub"><a href="4-geocentric-models.html#geocentric-models"><span class="toc-section-number">4</span> Geocentric Models</a>
<ul>
<li><a href="4.1-why-normal-distributions-are-normal.html#why-normal-distributions-are-normal"><span class="toc-section-number">4.1</span> Why normal distributions are normal</a></li>
<li><a href="4.2-a-language-for-describing-models.html#a-language-for-describing-models"><span class="toc-section-number">4.2</span> A language for describing models</a></li>
<li><a href="4.3-gaussian-model-of-height.html#gaussian-model-of-height"><span class="toc-section-number">4.3</span> Gaussian model of height</a></li>
<li><a href="4.4-linear-prediction.html#linear-prediction"><span class="toc-section-number">4.4</span> Linear prediction</a></li>
<li><a href="4.5-curves-from-lines.html#curves-from-lines"><span class="toc-section-number">4.5</span> Curves from lines</a></li>
<li><a href="4.6-practice-1.html#practice-1"><span class="toc-section-number">4.6</span> Practice</a></li>
</ul></li>
<li class="has-sub"><a href="5-the-many-variables-the-spurious-waffles.html#the-many-variables-the-spurious-waffles"><span class="toc-section-number">5</span> The Many Variables &amp; The Spurious Waffles</a>
<ul>
<li><a href="5.1-spurious-association.html#spurious-association"><span class="toc-section-number">5.1</span> Spurious association</a></li>
<li><a href="5.2-masked-relationship.html#masked-relationship"><span class="toc-section-number">5.2</span> Masked relationship</a></li>
<li><a href="5.3-categorical-variables.html#categorical-variables"><span class="toc-section-number">5.3</span> Categorical variables</a></li>
<li><a href="5.4-practice-2.html#practice-2"><span class="toc-section-number">5.4</span> Practice</a></li>
</ul></li>
<li class="has-sub"><a href="6-the-haunted-dag-the-causal-terror.html#the-haunted-dag-the-causal-terror"><span class="toc-section-number">6</span> The Haunted DAG &amp; The Causal Terror</a>
<ul>
<li><a href="6.1-multicollinearity.html#multicollinearity"><span class="toc-section-number">6.1</span> Multicollinearity</a></li>
<li><a href="6.2-post-treatment-bias.html#post-treatment-bias"><span class="toc-section-number">6.2</span> Post-treatment bias</a></li>
<li><a href="6.3-collider-bias.html#collider-bias"><span class="toc-section-number">6.3</span> Collider bias</a></li>
<li><a href="6.4-confronting-confounding.html#confronting-confounding"><span class="toc-section-number">6.4</span> Confronting confounding</a></li>
<li><a href="6.5-summary.html#summary"><span class="toc-section-number">6.5</span> Summary</a></li>
<li><a href="6.6-practice-3.html#practice-3"><span class="toc-section-number">6.6</span> Practice</a></li>
</ul></li>
<li class="has-sub"><a href="7-ulysses-compass.html#ulysses-compass"><span class="toc-section-number">7</span> Ulysses’ Compass</a>
<ul>
<li><a href="7.1-the-problem-with-parameters.html#the-problem-with-parameters"><span class="toc-section-number">7.1</span> The problem with parameters</a></li>
<li><a href="7.2-entropy-and-accuracy.html#entropy-and-accuracy"><span class="toc-section-number">7.2</span> Entropy and accuracy</a></li>
<li><a href="7.3-golem-taming-regularization.html#golem-taming-regularization"><span class="toc-section-number">7.3</span> Golem taming: regularization</a></li>
<li><a href="7.4-predicting-predictive-accuracy.html#predicting-predictive-accuracy"><span class="toc-section-number">7.4</span> Predicting predictive accuracy</a></li>
<li><a href="7.5-model-comparison.html#model-comparison"><span class="toc-section-number">7.5</span> Model comparison</a></li>
<li><a href="7.6-practice-4.html#practice-4"><span class="toc-section-number">7.6</span> Practice</a></li>
</ul></li>
<li class="has-sub"><a href="8-conditional-manatees.html#conditional-manatees"><span class="toc-section-number">8</span> Conditional Manatees</a>
<ul>
<li><a href="8.1-building-an-interaction.html#building-an-interaction"><span class="toc-section-number">8.1</span> Building an interaction</a></li>
<li><a href="8.2-symmetry-of-interactions.html#symmetry-of-interactions"><span class="toc-section-number">8.2</span> Symmetry of interactions</a></li>
<li><a href="8.3-continuous-interactions.html#continuous-interactions"><span class="toc-section-number">8.3</span> Continuous interactions</a></li>
</ul></li>
<li class="has-sub"><a href="9-markov-chain-monte-carlo-1.html#markov-chain-monte-carlo-1"><span class="toc-section-number">9</span> Markov Chain Monte Carlo</a>
<ul>
<li><a href="9.1-good-king-markov-and-his-island-kingdom.html#good-king-markov-and-his-island-kingdom"><span class="toc-section-number">9.1</span> Good King Markov and his island kingdom</a></li>
<li><a href="9.2-metropolis-algorithm.html#metropolis-algorithm"><span class="toc-section-number">9.2</span> Metropolis algorithm</a></li>
<li><a href="9.3-hamiltonian-monte-carlo.html#hamiltonian-monte-carlo"><span class="toc-section-number">9.3</span> Hamiltonian Monte Carlo</a></li>
<li><a href="9.4-easy-hmc-ulam.html#easy-hmc-ulam"><span class="toc-section-number">9.4</span> Easy HMC: <code>ulam</code></a></li>
<li><a href="9.5-care-and-feeding-of-your-markov-chain.html#care-and-feeding-of-your-markov-chain"><span class="toc-section-number">9.5</span> Care and feeding of your Markov chain</a></li>
</ul></li>
<li class="has-sub"><a href="10-big-entropy-and-the-generalized-linear-model.html#big-entropy-and-the-generalized-linear-model"><span class="toc-section-number">10</span> Big Entropy and the Generalized Linear Model</a>
<ul>
<li><a href="10.1-maximum-entropy.html#maximum-entropy"><span class="toc-section-number">10.1</span> Maximum entropy</a></li>
<li><a href="10.2-generalized-linear-models.html#generalized-linear-models"><span class="toc-section-number">10.2</span> Generalized linear models</a></li>
</ul></li>
<li class="has-sub"><a href="11-god-spiked-the-integers.html#god-spiked-the-integers"><span class="toc-section-number">11</span> God Spiked the Integers</a>
<ul>
<li><a href="11.1-binomial-regression.html#binomial-regression"><span class="toc-section-number">11.1</span> Binomial regression</a></li>
<li><a href="11.2-poisson-regression.html#poisson-regression"><span class="toc-section-number">11.2</span> Poisson regression</a></li>
<li><a href="11.3-multinomial-and-categorical-models.html#multinomial-and-categorical-models"><span class="toc-section-number">11.3</span> Multinomial and categorical models</a></li>
</ul></li>
<li class="has-sub"><a href="12-models-with-memory.html#models-with-memory"><span class="toc-section-number">12</span> Models With Memory</a>
<ul>
<li><a href="12.1-example-multilevel-tadpoles.html#example-multilevel-tadpoles"><span class="toc-section-number">12.1</span> Example: Multilevel tadpoles</a></li>
<li><a href="12.2-varying-effects-and-the-underfittingoverfitting-trade-off.html#varying-effects-and-the-underfittingoverfitting-trade-off"><span class="toc-section-number">12.2</span> Varying effects and the underfitting/overfitting trade-off</a></li>
<li><a href="12.3-more-than-one-type-of-cluster.html#more-than-one-type-of-cluster"><span class="toc-section-number">12.3</span> More than one type of cluster</a></li>
<li><a href="12.4-divergent-transitions-and-non-centered-priors.html#divergent-transitions-and-non-centered-priors"><span class="toc-section-number">12.4</span> Divergent transitions and non-centered priors</a></li>
<li><a href="12.5-multilevel-posterior-predictions.html#multilevel-posterior-predictions"><span class="toc-section-number">12.5</span> Multilevel posterior predictions</a></li>
</ul></li>
<li class="has-sub"><a href="13-adventures-in-covariance.html#adventures-in-covariance"><span class="toc-section-number">13</span> Adventures in Covariance</a>
<ul>
<li><a href="13.1-varying-slopes-by-construction.html#varying-slopes-by-construction"><span class="toc-section-number">13.1</span> Varying slopes by construction</a></li>
<li><a href="13.2-advanced-varying-slopes.html#advanced-varying-slopes"><span class="toc-section-number">13.2</span> Advanced varying slopes</a></li>
<li><a href="13.3-instruments-and-causal-designs.html#instruments-and-causal-designs"><span class="toc-section-number">13.3</span> Instruments and causal designs</a></li>
<li><a href="13.4-social-relations-as-correlated-varying-effects.html#social-relations-as-correlated-varying-effects"><span class="toc-section-number">13.4</span> Social relations as correlated varying effects</a></li>
<li><a href="13.5-continuous-categories-and-the-gaussian-process.html#continuous-categories-and-the-gaussian-process"><span class="toc-section-number">13.5</span> Continuous categories and the Gaussian process</a></li>
<li><a href="13.6-bonus-multilevel-growth-models-and-the-melsm.html#bonus-multilevel-growth-models-and-the-melsm"><span class="toc-section-number">13.6</span> Bonus: Multilevel growth models and the MELSM</a></li>
</ul></li>
<li class="has-sub"><a href="14-missing-data-and-other-opportunities.html#missing-data-and-other-opportunities"><span class="toc-section-number">14</span> Missing Data and Other Opportunities</a>
<ul>
<li><a href="14.1-measurement-error.html#measurement-error"><span class="toc-section-number">14.1</span> Measurement error</a></li>
<li><a href="14.2-missing-data.html#missing-data"><span class="toc-section-number">14.2</span> Missing data</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="measurement-error" class="section level2" number="14.1">
<h2><span class="header-section-number">14.1</span> Measurement error</h2>
<div class="figure">
<img src="slides/L20/11.png" alt="There's always some error in measurement, and ther'e always this sigma error. But what if there's also error on the predictors, and it's not consistent. Let's think about avoiding thying to be clever, and just codntiiong on what we know." width="80%" />
<p class="caption marginnote shownote">
There’s always some error in measurement, and ther’e always this sigma error. But what if there’s also error on the predictors, and it’s not consistent. Let’s think about avoiding thying to be clever, and just codntiiong on what we know.
</p>
</div>
<div class="figure">
<img src="slides/L20/12.png" alt="The columns were standard errors on a coulpl eof the variables. The error of measurement has been quantified. We have an esimate of the divors=ce rate, and the stnadared error stells us the error rate of that estiamte. SOome of the standard errors are big. " width="80%" />
<p class="caption marginnote shownote">
The columns were standard errors on a coulpl eof the variables. The error of measurement has been quantified. We have an esimate of the divors=ce rate, and the stnadared error stells us the error rate of that estiamte. SOome of the standard errors are big.
</p>
</div>
<div class="sourceCode" id="cb1234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1234-1"><a href="14.1-measurement-error.html#cb1234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(WaffleDivorce, <span class="at">package =</span> <span class="st">&quot;rethinking&quot;</span>)</span>
<span id="cb1234-2"><a href="14.1-measurement-error.html#cb1234-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> WaffleDivorce</span>
<span id="cb1234-3"><a href="14.1-measurement-error.html#cb1234-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(WaffleDivorce)</span></code></pre></div>
<div class="sourceCode" id="cb1235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1235-1"><a href="14.1-measurement-error.html#cb1235-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb1235-2"><a href="14.1-measurement-error.html#cb1235-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1235-3"><a href="14.1-measurement-error.html#cb1235-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">D_obs =</span> (Divorce <span class="sc">-</span> <span class="fu">mean</span>(Divorce)) <span class="sc">/</span> <span class="fu">sd</span>(Divorce),</span>
<span id="cb1235-4"><a href="14.1-measurement-error.html#cb1235-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">D_sd  =</span> Divorce.SE <span class="sc">/</span> <span class="fu">sd</span>(Divorce),</span>
<span id="cb1235-5"><a href="14.1-measurement-error.html#cb1235-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">M     =</span> (Marriage <span class="sc">-</span> <span class="fu">mean</span>(Marriage)) <span class="sc">/</span> <span class="fu">sd</span>(Marriage),</span>
<span id="cb1235-6"><a href="14.1-measurement-error.html#cb1235-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">A     =</span> (MedianAgeMarriage <span class="sc">-</span> <span class="fu">mean</span>(MedianAgeMarriage)) <span class="sc">/</span> <span class="fu">sd</span>(MedianAgeMarriage),</span>
<span id="cb1235-7"><a href="14.1-measurement-error.html#cb1235-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">M_obs =</span> M,</span>
<span id="cb1235-8"><a href="14.1-measurement-error.html#cb1235-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">M_sd  =</span> Marriage.SE <span class="sc">/</span> <span class="fu">sd</span>(Marriage))</span></code></pre></div>
<p>Set theme:</p>
<div class="sourceCode" id="cb1236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1236-1"><a href="14.1-measurement-error.html#cb1236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdark)</span>
<span id="cb1236-2"><a href="14.1-measurement-error.html#cb1236-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1236-3"><a href="14.1-measurement-error.html#cb1236-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(</span>
<span id="cb1236-4"><a href="14.1-measurement-error.html#cb1236-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dark_theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1236-5"><a href="14.1-measurement-error.html#cb1236-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb1236-6"><a href="14.1-measurement-error.html#cb1236-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb1236-7"><a href="14.1-measurement-error.html#cb1236-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Inverted geom defaults of fill and color/colour.
## To change them back, use invert_geom_defaults().</code></pre>
<div class="sourceCode" id="cb1238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1238-1"><a href="14.1-measurement-error.html#cb1238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to reset the default ggplot2 theme to its default parameters, execute both:</span></span>
<span id="cb1238-2"><a href="14.1-measurement-error.html#cb1238-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot2::theme_set(theme_gray())</span></span>
<span id="cb1238-3"><a href="14.1-measurement-error.html#cb1238-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ggdark::invert_geom_defaults()</span></span></code></pre></div>
<p>Figure 15.1a</p>
<div class="sourceCode" id="cb1239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1239-1"><a href="14.1-measurement-error.html#cb1239-1" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">7</span>]</span>
<span id="cb1239-2"><a href="14.1-measurement-error.html#cb1239-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1239-3"><a href="14.1-measurement-error.html#cb1239-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1239-4"><a href="14.1-measurement-error.html#cb1239-4" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb1239-5"><a href="14.1-measurement-error.html#cb1239-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MedianAgeMarriage, </span>
<span id="cb1239-6"><a href="14.1-measurement-error.html#cb1239-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> Divorce,</span>
<span id="cb1239-7"><a href="14.1-measurement-error.html#cb1239-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> Divorce <span class="sc">-</span> Divorce.SE, </span>
<span id="cb1239-8"><a href="14.1-measurement-error.html#cb1239-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymax =</span> Divorce <span class="sc">+</span> Divorce.SE)) <span class="sc">+</span></span>
<span id="cb1239-9"><a href="14.1-measurement-error.html#cb1239-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">shape =</span> <span class="dv">20</span>, <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb1239-10"><a href="14.1-measurement-error.html#cb1239-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Median age marriage&quot;</span> , </span>
<span id="cb1239-11"><a href="14.1-measurement-error.html#cb1239-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Divorce rate&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1240-1"><a href="14.1-measurement-error.html#cb1240-1" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">6</span>]</span>
<span id="cb1240-2"><a href="14.1-measurement-error.html#cb1240-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1240-3"><a href="14.1-measurement-error.html#cb1240-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1240-4"><a href="14.1-measurement-error.html#cb1240-4" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb1240-5"><a href="14.1-measurement-error.html#cb1240-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(Population), </span>
<span id="cb1240-6"><a href="14.1-measurement-error.html#cb1240-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> Divorce,</span>
<span id="cb1240-7"><a href="14.1-measurement-error.html#cb1240-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> Divorce <span class="sc">-</span> Divorce.SE, </span>
<span id="cb1240-8"><a href="14.1-measurement-error.html#cb1240-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymax =</span> Divorce <span class="sc">+</span> Divorce.SE)) <span class="sc">+</span></span>
<span id="cb1240-9"><a href="14.1-measurement-error.html#cb1240-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">shape =</span> <span class="dv">20</span>, <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb1240-10"><a href="14.1-measurement-error.html#cb1240-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1240-11"><a href="14.1-measurement-error.html#cb1240-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;log population&quot;</span>)</span>
<span id="cb1240-12"><a href="14.1-measurement-error.html#cb1240-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1240-13"><a href="14.1-measurement-error.html#cb1240-13" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code></pre></div>
<p><img src="15_missing_data_and_other_opportunities_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Just like in the text, our plot shows states with larger populations tend to have smaller measurement error. The relation between measurement error and <code>MedianAgeMarriage</code> is less apparent.</p>
<div class="figure">
<img src="slides/L20/13.png" alt="Right now has the log population on the horizontal. And California is on the right. It's so big that the error rate is small." width="80%" />
<p class="caption marginnote shownote">
Right now has the log population on the horizontal. And California is on the right. It’s so big that the error rate is small.
</p>
</div>
<div class="figure">
<img src="slides/L20/14.png" alt="Let's think about this in terms of a causal model. We want to see the divorce rate we observe as a function of the true divorce rate `D`, and the population size `N`. " width="80%" />
<p class="caption marginnote shownote">
Let’s think about this in terms of a causal model. We want to see the divorce rate we observe as a function of the true divorce rate <code>D</code>, and the population size <code>N</code>.
</p>
</div>
<div class="figure">
<img src="slides/L20/15.png" alt="Let's not be clever, just apply ruthless probability theory. There's some true divorce rate, and we'd like to use that as our outcome variable. Generatively thinking, our observed data is generated from a normal disttribution. The mean of this normal distribution will be the true rate. THen there's a standard deviation. In the long run, there's some D true. But in any finite period, ther's error, and that will be inversely proportional to population size." width="80%" />
<p class="caption marginnote shownote">
Let’s not be clever, just apply ruthless probability theory. There’s some true divorce rate, and we’d like to use that as our outcome variable. Generatively thinking, our observed data is generated from a normal disttribution. The mean of this normal distribution will be the true rate. THen there’s a standard deviation. In the long run, there’s some D true. But in any finite period, ther’s error, and that will be inversely proportional to population size.
</p>
</div>
<div class="figure">
<img src="slides/L20/16.png" alt="This was our DAG before. The thing on the top is D TRUE. We're going to put a line on top of it." width="80%" />
<p class="caption marginnote shownote">
This was our DAG before. The thing on the top is D TRUE. We’re going to put a line on top of it.
</p>
</div>
<div class="figure">
<img src="slides/L20/17.png" alt="... The observation process. Now D TRUE is's a vector of unkonwn parameters, then the line at the top estimates them for us. We also have the whole regression relationship that is going to pin down values from other states. Shrinkage is going to happen. If you were going to simulate pmeaurement error, this would be the model. Then it runs backwards. **Bayesian models are generative, and you can run them in both directions. If you run them forwards you simulate fake data, and if you run them in the reverse they spit out a posterior distribution. You feed in a distirbution and the spit out data, you feed in data they spit out a distribution.** So if you were going to simulate measurement error, you use the top line.  " width="80%" />
<p class="caption marginnote shownote">
… The observation process. Now D TRUE is’s a vector of unkonwn parameters, then the line at the top estimates them for us. We also have the whole regression relationship that is going to pin down values from other states. Shrinkage is going to happen. If you were going to simulate pmeaurement error, this would be the model. Then it runs backwards. <strong>Bayesian models are generative, and you can run them in both directions. If you run them forwards you simulate fake data, and if you run them in the reverse they spit out a posterior distribution. You feed in a distirbution and the spit out data, you feed in data they spit out a distribution.</strong> So if you were going to simulate measurement error, you use the top line.
</p>
</div>
<div class="figure">
<img src="slides/L20/18.png" alt="How do we do this in a model? For every dstate, there's a D true, and that's what the vector[N] is. " width="80%" />
<p class="caption marginnote shownote">
How do we do this in a model? For every dstate, there’s a D true, and that’s what the vector[N] is.
</p>
</div>
<p>With brms, we accommodate measurement error in the criterion using the <code>mi()</code> syntax, following the general form <code>&lt;response&gt; | mi(&lt;se_response&gt;)</code>. This follows a missing data logic, resulting in Bayesian missing data imputation for the criterion values</p>
<div class="sourceCode" id="cb1241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1241-1"><a href="14.1-measurement-error.html#cb1241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># put the data into a `list()`</span></span>
<span id="cb1241-2"><a href="14.1-measurement-error.html#cb1241-2" aria-hidden="true" tabindex="-1"></a>dlist <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1241-3"><a href="14.1-measurement-error.html#cb1241-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">D_obs =</span> d<span class="sc">$</span>D_obs,</span>
<span id="cb1241-4"><a href="14.1-measurement-error.html#cb1241-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">D_sd  =</span> d<span class="sc">$</span>D_sd,</span>
<span id="cb1241-5"><a href="14.1-measurement-error.html#cb1241-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">M     =</span> d<span class="sc">$</span>M,</span>
<span id="cb1241-6"><a href="14.1-measurement-error.html#cb1241-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">A     =</span> d<span class="sc">$</span>A)</span>
<span id="cb1241-7"><a href="14.1-measurement-error.html#cb1241-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1241-8"><a href="14.1-measurement-error.html#cb1241-8" aria-hidden="true" tabindex="-1"></a>b15<span class="fl">.1</span> <span class="ot">&lt;-</span> </span>
<span id="cb1241-9"><a href="14.1-measurement-error.html#cb1241-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> dlist, </span>
<span id="cb1241-10"><a href="14.1-measurement-error.html#cb1241-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1241-11"><a href="14.1-measurement-error.html#cb1241-11" aria-hidden="true" tabindex="-1"></a>      D_obs <span class="sc">|</span> <span class="fu">mi</span>(D_sd) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> A <span class="sc">+</span> M,</span>
<span id="cb1241-12"><a href="14.1-measurement-error.html#cb1241-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1241-13"><a href="14.1-measurement-error.html#cb1241-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb1241-14"><a href="14.1-measurement-error.html#cb1241-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb1241-15"><a href="14.1-measurement-error.html#cb1241-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1241-16"><a href="14.1-measurement-error.html#cb1241-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb1241-17"><a href="14.1-measurement-error.html#cb1241-17" aria-hidden="true" tabindex="-1"></a>      <span class="co"># note this line</span></span>
<span id="cb1241-18"><a href="14.1-measurement-error.html#cb1241-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">save_mevars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1241-19"><a href="14.1-measurement-error.html#cb1241-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b15.01&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1242-1"><a href="14.1-measurement-error.html#cb1242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b15<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: D_obs | mi(D_sd) ~ 1 + A + M 
##    Data: dlist (Number of observations: 50) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -0.06      0.10    -0.23     0.14 1.00     5130     3528
## A            -0.61      0.16    -0.92    -0.31 1.00     3953     3313
## M             0.05      0.17    -0.28     0.38 1.00     3801     2979
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     0.58      0.11     0.39     0.81 1.00     1615     1962
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="figure">
<img src="slides/L20/19.png" alt="Remember the distinction between likelihoods and priors in a Baeysian model is coginitive. Probabilityt theory don't care. When something in your dataset becomes unobserved, the model doesn't change. The model exists before you know the sample. The fact that you haven't observed some data doesn't mean the model chagnes. It cjust means you have paraemters there, because parameters are unobserved variables." width="80%" />
<p class="caption marginnote shownote">
Remember the distinction between likelihoods and priors in a Baeysian model is coginitive. Probabilityt theory don’t care. When something in your dataset becomes unobserved, the model doesn’t change. The model exists before you know the sample. The fact that you haven’t observed some data doesn’t mean the model chagnes. It cjust means you have paraemters there, because parameters are unobserved variables.
</p>
</div>
<p>Return the summaries for the <code>D_true[i]</code> parameters.</p>
<div class="sourceCode" id="cb1244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1244-1"><a href="14.1-measurement-error.html#cb1244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b15<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1244-2"><a href="14.1-measurement-error.html#cb1244-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1244-3"><a href="14.1-measurement-error.html#cb1244-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span></code></pre></div>
<pre><code>##             Estimate Est.Error   Q2.5  Q97.5
## b_Intercept    -0.06      0.10  -0.23   0.14
## b_A            -0.61      0.16  -0.92  -0.31
## b_M             0.05      0.17  -0.28   0.38
## sigma           0.58      0.11   0.39   0.81
## Yl[1]           1.16      0.36   0.46   1.89
## Yl[2]           0.69      0.57  -0.44   1.84
## Yl[3]           0.42      0.34  -0.24   1.12
## Yl[4]           1.42      0.48   0.50   2.38
## Yl[5]          -0.90      0.13  -1.15  -0.65
## Yl[6]           0.65      0.40  -0.12   1.46
## Yl[7]          -1.37      0.35  -2.06  -0.69
## Yl[8]          -0.35      0.49  -1.32   0.60
## Yl[9]          -1.89      0.59  -3.04  -0.75
## Yl[10]         -0.62      0.16  -0.94  -0.30
## Yl[11]          0.77      0.29   0.22   1.33
## Yl[12]         -0.55      0.48  -1.52   0.32
## Yl[13]          0.17      0.49  -0.82   1.11
## Yl[14]         -0.87      0.22  -1.32  -0.44
## Yl[15]          0.55      0.29  -0.02   1.13
## Yl[16]          0.29      0.37  -0.44   1.00
## Yl[17]          0.50      0.43  -0.32   1.34
## Yl[18]          1.25      0.35   0.59   1.94
## Yl[19]          0.42      0.39  -0.33   1.21
## Yl[20]          0.40      0.54  -0.59   1.48
## Yl[21]         -0.55      0.32  -1.17   0.08
## Yl[22]         -1.10      0.25  -1.59  -0.60
## Yl[23]         -0.27      0.26  -0.77   0.24
## Yl[24]         -1.00      0.29  -1.57  -0.42
## Yl[25]          0.42      0.41  -0.36   1.24
## Yl[26]         -0.03      0.31  -0.64   0.59
## Yl[27]         -0.01      0.50  -1.01   1.00
## Yl[28]         -0.15      0.38  -0.93   0.60
## Yl[29]         -0.27      0.50  -1.21   0.71
## Yl[30]         -1.80      0.23  -2.26  -1.35
## Yl[31]          0.17      0.43  -0.67   1.06
## Yl[32]         -1.66      0.16  -1.98  -1.34
## Yl[33]          0.12      0.24  -0.36   0.60
## Yl[34]         -0.05      0.51  -1.12   0.93
## Yl[35]         -0.13      0.23  -0.57   0.33
## Yl[36]          1.28      0.40   0.52   2.08
## Yl[37]          0.23      0.34  -0.44   0.90
## Yl[38]         -1.02      0.22  -1.45  -0.59
## Yl[39]         -0.93      0.54  -1.93   0.17
## Yl[40]         -0.68      0.31  -1.29  -0.08
## Yl[41]          0.25      0.54  -0.82   1.38
## Yl[42]          0.73      0.35   0.06   1.42
## Yl[43]          0.19      0.18  -0.15   0.54
## Yl[44]          0.80      0.43  -0.04   1.62
## Yl[45]         -0.40      0.54  -1.45   0.67
## Yl[46]         -0.39      0.26  -0.90   0.12
## Yl[47]          0.14      0.31  -0.46   0.74
## Yl[48]          0.55      0.47  -0.38   1.48
## Yl[49]         -0.64      0.28  -1.22  -0.10
## Yl[50]          0.85      0.60  -0.35   2.04
## lp__          -78.11      6.47 -91.50 -66.12</code></pre>
<div class="figure">
<img src="slides/L20/20.png" alt="There's shrinkage. Plotting the relationship between median age of marriage and the divorce rate. Most of these are standardised variables. The blue points are the values that were observed. The open circles are the values fromt eh posterior distribution. The line segments connect them for each state. There's shrinkage. Some have moved more than others. You can explain this pattern. Why have some moved way more than others? Thye've moved tothe regression line because that's the expectation. How much it shrinks is also a function of standard error. For ID it says given this relationship and these variables, that measred rate is too edteme to be beileveable, party due to sampling error, so it shirnks it. Wyoming is interesitn gbecause it'snot so far but so uncertain that it gets shrunk directly to the line. Maine gets shrunk a lot too. " width="80%" />
<p class="caption marginnote shownote">
There’s shrinkage. Plotting the relationship between median age of marriage and the divorce rate. Most of these are standardised variables. The blue points are the values that were observed. The open circles are the values fromt eh posterior distribution. The line segments connect them for each state. There’s shrinkage. Some have moved more than others. You can explain this pattern. Why have some moved way more than others? Thye’ve moved tothe regression line because that’s the expectation. How much it shrinks is also a function of standard error. For ID it says given this relationship and these variables, that measred rate is too edteme to be beileveable, party due to sampling error, so it shirnks it. Wyoming is interesitn gbecause it’snot so far but so uncertain that it gets shrunk directly to the line. Maine gets shrunk a lot too.
</p>
</div>
<p>Figure 15.2a</p>
<div class="sourceCode" id="cb1246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1246-1"><a href="14.1-measurement-error.html#cb1246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1246-2"><a href="14.1-measurement-error.html#cb1246-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1246-3"><a href="14.1-measurement-error.html#cb1246-3" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AL&quot;</span>, <span class="st">&quot;AR&quot;</span>, <span class="st">&quot;ME&quot;</span>, <span class="st">&quot;NH&quot;</span>, <span class="st">&quot;RI&quot;</span>, <span class="st">&quot;DC&quot;</span>, <span class="st">&quot;VT&quot;</span>, <span class="st">&quot;AK&quot;</span>, <span class="st">&quot;SD&quot;</span>, <span class="st">&quot;UT&quot;</span>, <span class="st">&quot;ID&quot;</span>, <span class="st">&quot;ND&quot;</span>, <span class="st">&quot;WY&quot;</span>)</span>
<span id="cb1246-4"><a href="14.1-measurement-error.html#cb1246-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1246-5"><a href="14.1-measurement-error.html#cb1246-5" aria-hidden="true" tabindex="-1"></a>d_est <span class="ot">&lt;-</span></span>
<span id="cb1246-6"><a href="14.1-measurement-error.html#cb1246-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">posterior_summary</span>(b15<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1246-7"><a href="14.1-measurement-error.html#cb1246-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1246-8"><a href="14.1-measurement-error.html#cb1246-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1246-9"><a href="14.1-measurement-error.html#cb1246-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">D_est =</span> Estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb1246-10"><a href="14.1-measurement-error.html#cb1246-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(term, D_est) <span class="sc">%&gt;%</span> </span>
<span id="cb1246-11"><a href="14.1-measurement-error.html#cb1246-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, <span class="st">&quot;Yl&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1246-12"><a href="14.1-measurement-error.html#cb1246-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(d)</span>
<span id="cb1246-13"><a href="14.1-measurement-error.html#cb1246-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1246-14"><a href="14.1-measurement-error.html#cb1246-14" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">5</span>]</span>
<span id="cb1246-15"><a href="14.1-measurement-error.html#cb1246-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1246-16"><a href="14.1-measurement-error.html#cb1246-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1246-17"><a href="14.1-measurement-error.html#cb1246-17" aria-hidden="true" tabindex="-1"></a>  d_est <span class="sc">%&gt;%</span></span>
<span id="cb1246-18"><a href="14.1-measurement-error.html#cb1246-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> D_sd, <span class="at">y =</span> D_est <span class="sc">-</span> D_obs)) <span class="sc">+</span></span>
<span id="cb1246-19"><a href="14.1-measurement-error.html#cb1246-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb1246-20"><a href="14.1-measurement-error.html#cb1246-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb1246-21"><a href="14.1-measurement-error.html#cb1246-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Loc <span class="sc">%in%</span> states),  </span>
<span id="cb1246-22"><a href="14.1-measurement-error.html#cb1246-22" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">label =</span> Loc), </span>
<span id="cb1246-23"><a href="14.1-measurement-error.html#cb1246-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">3</span>, <span class="at">seed =</span> <span class="dv">15</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) </span></code></pre></div>
<div class="figure">
<img src="slides/L20/21.png" alt="You can compare it to the plot with teh standard devations. Ont ehleft we've taken the differnce between the estimated and the observed. Horizontal is the standard error. Any state taht has adifference of 0 means there's no shrinkage. " width="80%" />
<p class="caption marginnote shownote">
You can compare it to the plot with teh standard devations. Ont ehleft we’ve taken the differnce between the estimated and the observed. Horizontal is the standard error. Any state taht has adifference of 0 means there’s no shrinkage.
</p>
</div>
<p>Figure 15.2b</p>
<div class="sourceCode" id="cb1247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1247-1"><a href="14.1-measurement-error.html#cb1247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb1247-2"><a href="14.1-measurement-error.html#cb1247-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1247-3"><a href="14.1-measurement-error.html#cb1247-3" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AR&quot;</span>, <span class="st">&quot;ME&quot;</span>, <span class="st">&quot;RI&quot;</span>, <span class="st">&quot;ID&quot;</span>, <span class="st">&quot;WY&quot;</span>, <span class="st">&quot;ND&quot;</span>, <span class="st">&quot;MN&quot;</span>)</span>
<span id="cb1247-4"><a href="14.1-measurement-error.html#cb1247-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1247-5"><a href="14.1-measurement-error.html#cb1247-5" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">4</span>]</span>
<span id="cb1247-6"><a href="14.1-measurement-error.html#cb1247-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1247-7"><a href="14.1-measurement-error.html#cb1247-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1247-8"><a href="14.1-measurement-error.html#cb1247-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">posterior_samples</span>(b15<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1247-9"><a href="14.1-measurement-error.html#cb1247-9" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">expand</span>(<span class="fu">nesting</span>(b_Intercept, b_A),</span>
<span id="cb1247-10"><a href="14.1-measurement-error.html#cb1247-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">A =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="fl">3.5</span>, <span class="at">to =</span> <span class="fl">3.5</span>, <span class="at">length.out =</span> <span class="dv">50</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1247-11"><a href="14.1-measurement-error.html#cb1247-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fitted =</span> b_Intercept <span class="sc">+</span> b_A <span class="sc">*</span> A) <span class="sc">%&gt;%</span> </span>
<span id="cb1247-12"><a href="14.1-measurement-error.html#cb1247-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1247-13"><a href="14.1-measurement-error.html#cb1247-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> A)) <span class="sc">+</span></span>
<span id="cb1247-14"><a href="14.1-measurement-error.html#cb1247-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb1247-15"><a href="14.1-measurement-error.html#cb1247-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">.width =</span> .<span class="dv">95</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;grey20&quot;</span>) <span class="sc">+</span></span>
<span id="cb1247-16"><a href="14.1-measurement-error.html#cb1247-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> d_est,</span>
<span id="cb1247-17"><a href="14.1-measurement-error.html#cb1247-17" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">xend =</span> A,</span>
<span id="cb1247-18"><a href="14.1-measurement-error.html#cb1247-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> D_obs, <span class="at">yend =</span> D_est),</span>
<span id="cb1247-19"><a href="14.1-measurement-error.html#cb1247-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1247-20"><a href="14.1-measurement-error.html#cb1247-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> d_est,</span>
<span id="cb1247-21"><a href="14.1-measurement-error.html#cb1247-21" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> D_obs),</span>
<span id="cb1247-22"><a href="14.1-measurement-error.html#cb1247-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb1247-23"><a href="14.1-measurement-error.html#cb1247-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> d_est,</span>
<span id="cb1247-24"><a href="14.1-measurement-error.html#cb1247-24" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> D_est),</span>
<span id="cb1247-25"><a href="14.1-measurement-error.html#cb1247-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">stroke =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1247-26"><a href="14.1-measurement-error.html#cb1247-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Loc <span class="sc">%in%</span> states),  </span>
<span id="cb1247-27"><a href="14.1-measurement-error.html#cb1247-27" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">y =</span> D_obs, <span class="at">label =</span> Loc), </span>
<span id="cb1247-28"><a href="14.1-measurement-error.html#cb1247-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">3</span>, <span class="at">seed =</span> <span class="dv">15</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb1247-29"><a href="14.1-measurement-error.html#cb1247-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;median age marriage (std)&quot;</span>,</span>
<span id="cb1247-30"><a href="14.1-measurement-error.html#cb1247-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;divorce rate (std)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1247-31"><a href="14.1-measurement-error.html#cb1247-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(d<span class="sc">$</span>A), </span>
<span id="cb1247-32"><a href="14.1-measurement-error.html#cb1247-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(d<span class="sc">$</span>D_obs))</span></code></pre></div>
<div class="sourceCode" id="cb1248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1248-1"><a href="14.1-measurement-error.html#cb1248-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code></pre></div>
<div class="figure">
<img src="15_missing_data_and_other_opportunities_files/figure-html/unnamed-chunk-32-1.png" alt="Figure 15.2" width="672" />
<p class="caption marginnote shownote">
Figure 15.2
</p>
</div>
<p><strong><em>15.1.2. Error on both outcome and predictor</em></strong></p>
<div class="figure">
<img src="slides/L20/22.png" alt="That's error on the outcome. YOu can also have error on predictor variables. Imagine sampling a predictor now with error. On the plot on this slide we have the marriage rate. On the horizontal against log population. " width="80%" />
<p class="caption marginnote shownote">
That’s error on the outcome. YOu can also have error on predictor variables. Imagine sampling a predictor now with error. On the plot on this slide we have the marriage rate. On the horizontal against log population.
</p>
</div>
<div class="figure">
<img src="slides/L20/23.png" alt="Top part is the observation process on divorce rate. Then the regression of the true divorce rate on age of marriage and marriage rate. But now inside the regression, we have..." width="80%" />
<p class="caption marginnote shownote">
Top part is the observation process on divorce rate. Then the regression of the true divorce rate on age of marriage and marriage rate. But now inside the regression, we have…
</p>
</div>
<div class="figure">
<img src="slides/L20/24.png" alt="M true, not the observed M, and that's a paramter. There's a parameter for each state and it goes in. It's a parameter times a parameter. Every state will have one of this M trues. Same model because it's the same generative process. Then we have the likelihood for the observed rate, the M observed for each state comes from this sampling process again.  " width="80%" />
<p class="caption marginnote shownote">
M true, not the observed M, and that’s a paramter. There’s a parameter for each state and it goes in. It’s a parameter times a parameter. Every state will have one of this M trues. Same model because it’s the same generative process. Then we have the likelihood for the observed rate, the M observed for each state comes from this sampling process again.
</p>
</div>
<div class="figure">
<img src="slides/L20/25.png" alt="You ahve to put in a prior for the MTrues. What hapens as a consquence of setting it as Normal(0, 1), because it's standaredised. Not terrible. Butyou're ignoring oinfoamtion inthe data because if i tele you the age of marrige in each state, you get information about themarriage rate. If you believe the DAG, age of marrige influence marriage rate. So we can get a better prior if we put the whole DAG into the model. If we do it all ato once, there's even more infomration. " width="80%" />
<p class="caption marginnote shownote">
You ahve to put in a prior for the MTrues. What hapens as a consquence of setting it as Normal(0, 1), because it’s standaredised. Not terrible. Butyou’re ignoring oinfoamtion inthe data because if i tele you the age of marrige in each state, you get information about themarriage rate. If you believe the DAG, age of marrige influence marriage rate. So we can get a better prior if we put the whole DAG into the model. If we do it all ato once, there’s even more infomration.
</p>
</div>
<div class="sourceCode" id="cb1249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1249-1"><a href="14.1-measurement-error.html#cb1249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># put the data into a `list()`</span></span>
<span id="cb1249-2"><a href="14.1-measurement-error.html#cb1249-2" aria-hidden="true" tabindex="-1"></a>dlist <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1249-3"><a href="14.1-measurement-error.html#cb1249-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">D_obs =</span> d<span class="sc">$</span>D_obs,</span>
<span id="cb1249-4"><a href="14.1-measurement-error.html#cb1249-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">D_sd  =</span> d<span class="sc">$</span>D_sd,</span>
<span id="cb1249-5"><a href="14.1-measurement-error.html#cb1249-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">M_obs =</span> d<span class="sc">$</span>M_obs,</span>
<span id="cb1249-6"><a href="14.1-measurement-error.html#cb1249-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">M_sd  =</span> d<span class="sc">$</span>M_sd,</span>
<span id="cb1249-7"><a href="14.1-measurement-error.html#cb1249-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">A     =</span> d<span class="sc">$</span>A)</span>
<span id="cb1249-8"><a href="14.1-measurement-error.html#cb1249-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1249-9"><a href="14.1-measurement-error.html#cb1249-9" aria-hidden="true" tabindex="-1"></a>b15<span class="fl">.2</span> <span class="ot">&lt;-</span> </span>
<span id="cb1249-10"><a href="14.1-measurement-error.html#cb1249-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> dlist, </span>
<span id="cb1249-11"><a href="14.1-measurement-error.html#cb1249-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1249-12"><a href="14.1-measurement-error.html#cb1249-12" aria-hidden="true" tabindex="-1"></a>      D_obs <span class="sc">|</span> <span class="fu">mi</span>(D_sd) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> A <span class="sc">+</span> <span class="fu">me</span>(M_obs, M_sd),</span>
<span id="cb1249-13"><a href="14.1-measurement-error.html#cb1249-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1249-14"><a href="14.1-measurement-error.html#cb1249-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb1249-15"><a href="14.1-measurement-error.html#cb1249-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> meanme),</span>
<span id="cb1249-16"><a href="14.1-measurement-error.html#cb1249-16" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb1249-17"><a href="14.1-measurement-error.html#cb1249-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1249-18"><a href="14.1-measurement-error.html#cb1249-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb1249-19"><a href="14.1-measurement-error.html#cb1249-19" aria-hidden="true" tabindex="-1"></a>      <span class="co"># note this line</span></span>
<span id="cb1249-20"><a href="14.1-measurement-error.html#cb1249-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">save_mevars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1249-21"><a href="14.1-measurement-error.html#cb1249-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b15.02&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1250-1"><a href="14.1-measurement-error.html#cb1250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b15<span class="fl">.2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1250-2"><a href="14.1-measurement-error.html#cb1250-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##                 Estimate Est.Error    Q2.5   Q97.5
## b_Intercept        -0.03      0.10   -0.22    0.16
## b_A                -0.52      0.16   -0.83   -0.21
## bsp_meM_obsM_sd     0.26      0.22   -0.18    0.68
## sigma               0.55      0.11    0.35    0.77
## Yl[1]               1.13      0.36    0.43    1.86
## Yl[2]               0.73      0.54   -0.31    1.82
## Yl[3]               0.42      0.33   -0.21    1.07
## Yl[4]               1.47      0.45    0.61    2.35
## Yl[5]              -0.90      0.13   -1.14   -0.65
## Yl[6]               0.71      0.39   -0.06    1.50
## Yl[7]              -1.35      0.35   -2.02   -0.67
## Yl[8]              -0.27      0.48   -1.21    0.66
## Yl[9]              -1.70      0.61   -2.87   -0.50
## Yl[10]             -0.63      0.16   -0.95   -0.30
## Yl[11]              0.78      0.28    0.24    1.34
## Yl[12]             -0.44      0.46   -1.37    0.46
## Yl[13]              0.20      0.49   -0.80    1.12
## Yl[14]             -0.87      0.23   -1.33   -0.42
## Yl[15]              0.54      0.30   -0.03    1.11
## Yl[16]              0.30      0.37   -0.45    1.00
## Yl[17]              0.51      0.40   -0.29    1.32
## Yl[18]              1.24      0.35    0.57    1.94
## Yl[19]              0.42      0.38   -0.31    1.18
## Yl[20]              0.21      0.54   -0.82    1.33
## Yl[21]             -0.55      0.31   -1.16    0.08
## Yl[22]             -1.10      0.26   -1.60   -0.58
## Yl[23]             -0.30      0.25   -0.81    0.20
## Yl[24]             -1.04      0.29   -1.61   -0.48
## Yl[25]              0.41      0.41   -0.36    1.21
## Yl[26]             -0.05      0.31   -0.66    0.54
## Yl[27]             -0.05      0.50   -1.09    0.95
## Yl[28]             -0.16      0.38   -0.93    0.57
## Yl[29]             -0.30      0.49   -1.23    0.65
## Yl[30]             -1.81      0.23   -2.26   -1.36
## Yl[31]              0.17      0.41   -0.64    1.00
## Yl[32]             -1.65      0.17   -1.97   -1.32
## Yl[33]              0.12      0.24   -0.35    0.59
## Yl[34]             -0.01      0.49   -0.99    0.96
## Yl[35]             -0.15      0.22   -0.58    0.29
## Yl[36]              1.29      0.41    0.49    2.07
## Yl[37]              0.20      0.34   -0.44    0.88
## Yl[38]             -1.04      0.21   -1.46   -0.63
## Yl[39]             -0.92      0.53   -1.93    0.15
## Yl[40]             -0.68      0.32   -1.31   -0.07
## Yl[41]              0.23      0.54   -0.80    1.33
## Yl[42]              0.70      0.33    0.05    1.35
## Yl[43]              0.20      0.18   -0.14    0.55
## Yl[44]              0.88      0.42    0.01    1.68
## Yl[45]             -0.43      0.52   -1.41    0.60
## Yl[46]             -0.37      0.25   -0.86    0.12
## Yl[47]              0.15      0.30   -0.44    0.74
## Yl[48]              0.56      0.46   -0.35    1.47
## Yl[49]             -0.65      0.27   -1.20   -0.12
## Yl[50]              0.83      0.53   -0.27    1.83
## meanme_meM_obs     -0.10      0.12   -0.34    0.13
## sdme_meM_obs        0.81      0.11    0.62    1.04
## Xme_meM_obs[1]      0.08      0.31   -0.51    0.70
## Xme_meM_obs[2]      0.79      0.55   -0.30    1.86
## Xme_meM_obs[3]      0.06      0.24   -0.40    0.52
## Xme_meM_obs[4]      1.28      0.40    0.50    2.05
## Xme_meM_obs[5]     -0.27      0.10   -0.48   -0.07
## Xme_meM_obs[6]      0.78      0.31    0.17    1.37
## Xme_meM_obs[7]     -0.75      0.26   -1.27   -0.24
## Xme_meM_obs[8]      0.33      0.54   -0.70    1.42
## Xme_meM_obs[9]     -0.44      0.52   -1.43    0.62
## Xme_meM_obs[10]    -0.80      0.15   -1.09   -0.49
## Xme_meM_obs[11]     0.50      0.20    0.11    0.89
## Xme_meM_obs[12]     0.64      0.52   -0.38    1.68
## Xme_meM_obs[13]     0.89      0.44    0.03    1.78
## Xme_meM_obs[14]    -0.57      0.16   -0.89   -0.26
## Xme_meM_obs[15]    -0.07      0.21   -0.48    0.34
## Xme_meM_obs[16]     0.28      0.36   -0.40    0.98
## Xme_meM_obs[17]     0.41      0.35   -0.27    1.08
## Xme_meM_obs[18]     0.51      0.28   -0.03    1.06
## Xme_meM_obs[19]     0.11      0.28   -0.45    0.68
## Xme_meM_obs[20]    -1.37      0.34   -2.05   -0.70
## Xme_meM_obs[21]    -0.43      0.25   -0.92    0.06
## Xme_meM_obs[22]    -1.07      0.18   -1.42   -0.73
## Xme_meM_obs[23]    -0.90      0.17   -1.24   -0.55
## Xme_meM_obs[24]    -1.21      0.20   -1.61   -0.82
## Xme_meM_obs[25]    -0.14      0.36   -0.89    0.56
## Xme_meM_obs[26]    -0.38      0.21   -0.77    0.03
## Xme_meM_obs[27]    -0.31      0.48   -1.29    0.62
## Xme_meM_obs[28]    -0.16      0.34   -0.83    0.52
## Xme_meM_obs[29]    -0.66      0.40   -1.44    0.13
## Xme_meM_obs[30]    -1.37      0.15   -1.65   -1.08
## Xme_meM_obs[31]     0.04      0.43   -0.81    0.87
## Xme_meM_obs[32]    -0.86      0.13   -1.11   -0.61
## Xme_meM_obs[33]     0.06      0.24   -0.43    0.53
## Xme_meM_obs[34]     0.71      0.58   -0.40    1.85
## Xme_meM_obs[35]    -0.81      0.15   -1.10   -0.51
## Xme_meM_obs[36]     0.84      0.31    0.23    1.45
## Xme_meM_obs[37]    -0.27      0.27   -0.80    0.27
## Xme_meM_obs[38]    -1.19      0.13   -1.44   -0.93
## Xme_meM_obs[39]    -0.91      0.47   -1.84    0.02
## Xme_meM_obs[40]    -0.50      0.29   -1.08    0.07
## Xme_meM_obs[41]    -0.03      0.51   -1.06    0.99
## Xme_meM_obs[42]    -0.16      0.22   -0.58    0.27
## Xme_meM_obs[43]     0.34      0.16    0.04    0.66
## Xme_meM_obs[44]     1.72      0.43    0.87    2.59
## Xme_meM_obs[45]    -0.62      0.49   -1.59    0.33
## Xme_meM_obs[46]     0.08      0.21   -0.33    0.49
## Xme_meM_obs[47]     0.30      0.25   -0.18    0.77
## Xme_meM_obs[48]     0.40      0.39   -0.38    1.17
## Xme_meM_obs[49]    -0.74      0.20   -1.12   -0.36
## Xme_meM_obs[50]     0.93      0.65   -0.28    2.24
## lp__             -163.86      9.80 -184.23 -145.48</code></pre>
<div class="figure">
<img src="slides/L20/26.png" alt="We've got two variables now, which are observed with error. Divorce rate on vertical; marigage rate on horitzontal. Open points are the corresponding pairs of posterior means for the esitmate true means. So we have shrinkage in two directions now towards some regression line (undrawn). Some shirnk a lot more than others. If you're really far from the line you shrink more. But also there's more shrinkage for the diveroce rate than the marriage rate. Top left is extreme in both. Comes downa  lot more on divorce rate. WHy?" width="80%" />
<p class="caption marginnote shownote">
We’ve got two variables now, which are observed with error. Divorce rate on vertical; marigage rate on horitzontal. Open points are the corresponding pairs of posterior means for the esitmate true means. So we have shrinkage in two directions now towards some regression line (undrawn). Some shirnk a lot more than others. If you’re really far from the line you shrink more. But also there’s more shrinkage for the diveroce rate than the marriage rate. Top left is extreme in both. Comes downa lot more on divorce rate. WHy?
</p>
</div>
<div class="sourceCode" id="cb1252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1252-1"><a href="14.1-measurement-error.html#cb1252-1" aria-hidden="true" tabindex="-1"></a>color_y <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">7</span>]</span>
<span id="cb1252-2"><a href="14.1-measurement-error.html#cb1252-2" aria-hidden="true" tabindex="-1"></a>color_p <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">2</span>]</span>
<span id="cb1252-3"><a href="14.1-measurement-error.html#cb1252-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1252-4"><a href="14.1-measurement-error.html#cb1252-4" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb1252-5"><a href="14.1-measurement-error.html#cb1252-5" aria-hidden="true" tabindex="-1"></a><span class="fu">full_join</span>(</span>
<span id="cb1252-6"><a href="14.1-measurement-error.html#cb1252-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># D</span></span>
<span id="cb1252-7"><a href="14.1-measurement-error.html#cb1252-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">Loc   =</span> d <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Loc),</span>
<span id="cb1252-8"><a href="14.1-measurement-error.html#cb1252-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">D_obs =</span> d <span class="sc">%&gt;%</span> <span class="fu">pull</span>(D_obs),</span>
<span id="cb1252-9"><a href="14.1-measurement-error.html#cb1252-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">D_est =</span> <span class="fu">posterior_summary</span>(b15<span class="fl">.2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1252-10"><a href="14.1-measurement-error.html#cb1252-10" aria-hidden="true" tabindex="-1"></a>           <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1252-11"><a href="14.1-measurement-error.html#cb1252-11" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1252-12"><a href="14.1-measurement-error.html#cb1252-12" aria-hidden="true" tabindex="-1"></a>           <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, <span class="st">&quot;Yl&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1252-13"><a href="14.1-measurement-error.html#cb1252-13" aria-hidden="true" tabindex="-1"></a>           <span class="fu">pull</span>(Estimate)) <span class="sc">%&gt;%</span> </span>
<span id="cb1252-14"><a href="14.1-measurement-error.html#cb1252-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">-</span>Loc, <span class="at">values_to =</span> <span class="st">&quot;d&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1252-15"><a href="14.1-measurement-error.html#cb1252-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;D_obs&quot;</span>, <span class="st">&quot;observed&quot;</span>, <span class="st">&quot;posterior&quot;</span>)),</span>
<span id="cb1252-16"><a href="14.1-measurement-error.html#cb1252-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># M</span></span>
<span id="cb1252-17"><a href="14.1-measurement-error.html#cb1252-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">Loc   =</span> d <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Loc),</span>
<span id="cb1252-18"><a href="14.1-measurement-error.html#cb1252-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">M_obs =</span> d <span class="sc">%&gt;%</span> <span class="fu">pull</span>(M_obs),</span>
<span id="cb1252-19"><a href="14.1-measurement-error.html#cb1252-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">M_est =</span> <span class="fu">posterior_summary</span>(b15<span class="fl">.2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1252-20"><a href="14.1-measurement-error.html#cb1252-20" aria-hidden="true" tabindex="-1"></a>           <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1252-21"><a href="14.1-measurement-error.html#cb1252-21" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1252-22"><a href="14.1-measurement-error.html#cb1252-22" aria-hidden="true" tabindex="-1"></a>           <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, <span class="st">&quot;Xme_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1252-23"><a href="14.1-measurement-error.html#cb1252-23" aria-hidden="true" tabindex="-1"></a>           <span class="fu">pull</span>(Estimate)) <span class="sc">%&gt;%</span> </span>
<span id="cb1252-24"><a href="14.1-measurement-error.html#cb1252-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">-</span>Loc, <span class="at">values_to =</span> <span class="st">&quot;m&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1252-25"><a href="14.1-measurement-error.html#cb1252-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;M_obs&quot;</span>, <span class="st">&quot;observed&quot;</span>, <span class="st">&quot;posterior&quot;</span>)),</span>
<span id="cb1252-26"><a href="14.1-measurement-error.html#cb1252-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Loc&quot;</span>, <span class="st">&quot;name&quot;</span>)</span>
<span id="cb1252-27"><a href="14.1-measurement-error.html#cb1252-27" aria-hidden="true" tabindex="-1"></a>)  <span class="sc">%&gt;%</span> </span>
<span id="cb1252-28"><a href="14.1-measurement-error.html#cb1252-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1252-29"><a href="14.1-measurement-error.html#cb1252-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb1252-30"><a href="14.1-measurement-error.html#cb1252-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> m, <span class="at">y =</span> d)) <span class="sc">+</span></span>
<span id="cb1252-31"><a href="14.1-measurement-error.html#cb1252-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Loc),</span>
<span id="cb1252-32"><a href="14.1-measurement-error.html#cb1252-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1252-33"><a href="14.1-measurement-error.html#cb1252-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb1252-34"><a href="14.1-measurement-error.html#cb1252-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(color_p, color_y)) <span class="sc">+</span></span>
<span id="cb1252-35"><a href="14.1-measurement-error.html#cb1252-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Shrinkage of both divorce rate and marriage rate&quot;</span>, </span>
<span id="cb1252-36"><a href="14.1-measurement-error.html#cb1252-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Marriage rate (std)&quot;</span> , </span>
<span id="cb1252-37"><a href="14.1-measurement-error.html#cb1252-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Divorce rate (std)&quot;</span>)</span></code></pre></div>
<img src="15_missing_data_and_other_opportunities_files/figure-html/15.6-1.png" width="672" />
<div class="figure">
<img src="slides/L20/27.png" alt="Because the regression says marriage rate isn't strongly associtated. It doesn 't know where to move it, so it doesn't.  " width="80%" />
<p class="caption marginnote shownote">
Because the regression says marriage rate isn’t strongly associtated. It doesn ’t know where to move it, so it doesn’t.
</p>
</div>
<div class="figure">
<img src="slides/L20/28.png" alt="It comes in many disguises. Simplest is when there's variable that's called 'error'. But there are many more subtle forms. Pre-averaging removes the fact tht you have a finite sample to estimate the mean from. That takes variation out of the dataset. If you're doing that constantly, that's cheating. Otherwise you could just use a MLM. Then the means are varying effects - parameters - and you do the averaging within the model. And all the uncertainty to do with different sample sizes is taken care of. Parentage analysis is a fun case. Say you have a popuation of wild rodents and you're tyring to figure out who was whose parents. So you get their genotypes and figure out how they're related. Phylogenetics - the example last week used a single tree. Phylogenies are rarely very certain. Trend to plot them like on the right, so you're showing the whole posterior distribution. You can do the analysis over the whole distribution of trees. In archaology, measurement error is the norm, e.g. radio carbon dating. People take this very seriously now. Very difficult to sex a fossil. Or studying a place where they don't keep track of birthdays." width="80%" />
<p class="caption marginnote shownote">
It comes in many disguises. Simplest is when there’s variable that’s called ‘error’. But there are many more subtle forms. Pre-averaging removes the fact tht you have a finite sample to estimate the mean from. That takes variation out of the dataset. If you’re doing that constantly, that’s cheating. Otherwise you could just use a MLM. Then the means are varying effects - parameters - and you do the averaging within the model. And all the uncertainty to do with different sample sizes is taken care of. Parentage analysis is a fun case. Say you have a popuation of wild rodents and you’re tyring to figure out who was whose parents. So you get their genotypes and figure out how they’re related. Phylogenetics - the example last week used a single tree. Phylogenies are rarely very certain. Trend to plot them like on the right, so you’re showing the whole posterior distribution. You can do the analysis over the whole distribution of trees. In archaology, measurement error is the norm, e.g. radio carbon dating. People take this very seriously now. Very difficult to sex a fossil. Or studying a place where they don’t keep track of birthdays.
</p>
</div>
<p><strong><em>15.1.3. Measurement terrors</em></strong></p>
</div>
<p style="text-align: center;">
<a href="14-missing-data-and-other-opportunities.html"><button class="btn btn-default">Previous</button></a>
<a href="14.2-missing-data.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
