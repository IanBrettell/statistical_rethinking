<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Homework: week 1 | Chapter 4. Geocentric Models" />
<meta property="og:type" content="book" />






<meta name="date" content="2021-05-12" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="Homework: week 1 | Chapter 4. Geocentric Models">

<title>Homework: week 1 | Chapter 4. Geocentric Models</title>

<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="preface.html#preface">Preface</a>
<ul>
<li><a href="0-1-install-packages.html#install-packages"><span class="toc-section-number">0.1</span> Install packages</a></li>
<li><a href="0-2-split-and-convert-slides.html#split-and-convert-slides"><span class="toc-section-number">0.2</span> Split and convert slides</a></li>
<li><a href="0-3-create-markdown-code-to-incorporate-slides.html#create-markdown-code-to-incorporate-slides"><span class="toc-section-number">0.3</span> Create markdown code to incorporate slides</a></li>
</ul></li>
<li><a href="1-the-golem-of-prague.html#the-golem-of-prague"><span class="toc-section-number">1</span> The Golem of Prague</a></li>
<li><a href="2-small-worlds-and-large-worlds.html#small-worlds-and-large-worlds"><span class="toc-section-number">2</span> Small Worlds and Large Worlds</a>
<ul>
<li><a href="2-1-the-garden-of-forking-data.html#the-garden-of-forking-data"><span class="toc-section-number">2.1</span> The garden of forking data</a></li>
<li><a href="2-2-building-a-model.html#building-a-model"><span class="toc-section-number">2.2</span> Building a model</a></li>
<li><a href="2-3-components-of-the-model.html#components-of-the-model"><span class="toc-section-number">2.3</span> Components of the model</a></li>
<li><a href="2-4-making-the-model-go.html#making-the-model-go"><span class="toc-section-number">2.4</span> Making the model go</a></li>
</ul></li>
<li><a href="3-sampling-from-the-imaginary.html#sampling-from-the-imaginary"><span class="toc-section-number">3</span> Sampling from the Imaginary</a>
<ul>
<li><a href="3-1-sampling-from-a-grid-approximate-posterior.html#sampling-from-a-grid-approximate-posterior"><span class="toc-section-number">3.1</span> Sampling from a grid-approximate posterior</a></li>
<li><a href="3-2-sampling-to-summarize.html#sampling-to-summarize"><span class="toc-section-number">3.2</span> Sampling to summarize</a>
<ul>
<li><a href="3-2-sampling-to-summarize.html#intervals-of-defined-boundaries"><span class="toc-section-number">3.2.1</span> Intervals of defined boundaries</a></li>
<li><a href="3-2-sampling-to-summarize.html#intervals-of-defined-mass"><span class="toc-section-number">3.2.2</span> Intervals of defined mass</a></li>
<li><a href="3-2-sampling-to-summarize.html#point-estimates"><span class="toc-section-number">3.2.3</span> Point estimates</a></li>
</ul></li>
<li><a href="3-3-sampling-to-simulate-prediction.html#sampling-to-simulate-prediction"><span class="toc-section-number">3.3</span> Sampling to simulate prediction</a>
<ul>
<li><a href="3-3-sampling-to-simulate-prediction.html#dummy-data"><span class="toc-section-number">3.3.1</span> Dummy data</a></li>
<li><a href="3-3-sampling-to-simulate-prediction.html#model-checking"><span class="toc-section-number">3.3.2</span> Model checking</a></li>
</ul></li>
<li><a href="practice.html#practice">Practice</a></li>
<li><a href="homework-week-1.html#homework-week-1">Homework: week 1</a></li>
</ul></li>
<li><a href="4-setup.html#setup"><span class="toc-section-number">4</span> Setup</a></li>
<li><a href="5-text.html#text"><span class="toc-section-number">5</span> Text</a>
<ul>
<li><a href="5-1-why-normal-distributions-are-normal.html#why-normal-distributions-are-normal"><span class="toc-section-number">5.1</span> Why normal distributions are normal</a>
<ul>
<li><a href="5-1-why-normal-distributions-are-normal.html#normal-by-addition"><span class="toc-section-number">5.1.1</span> Normal by addition</a></li>
<li><a href="5-1-why-normal-distributions-are-normal.html#normal-by-multiplication"><span class="toc-section-number">5.1.2</span> Normal by multiplication</a></li>
<li><a href="5-1-why-normal-distributions-are-normal.html#normal-by-log-multiplication"><span class="toc-section-number">5.1.3</span> Normal by log-multiplication</a></li>
<li><a href="5-1-why-normal-distributions-are-normal.html#using-gaussian-distributions"><span class="toc-section-number">5.1.4</span> Using Gaussian distributions</a></li>
</ul></li>
<li><a href="5-2-a-language-for-describing-models.html#a-language-for-describing-models"><span class="toc-section-number">5.2</span> A language for describing models</a>
<ul>
<li><a href="5-2-a-language-for-describing-models.html#re-describing-the-glob-tossing-model"><span class="toc-section-number">5.2.1</span> Re-describing the glob tossing model</a></li>
</ul></li>
<li><a href="5-3-gaussian-model-of-height.html#gaussian-model-of-height"><span class="toc-section-number">5.3</span> Gaussian model of height</a>
<ul>
<li><a href="5-3-gaussian-model-of-height.html#the-data"><span class="toc-section-number">5.3.1</span> The data</a></li>
<li><a href="5-3-gaussian-model-of-height.html#the-model"><span class="toc-section-number">5.3.2</span> The model</a></li>
<li><a href="5-3-gaussian-model-of-height.html#grid-approximation-of-the-posterior-distribution"><span class="toc-section-number">5.3.3</span> Grid approximation of the posterior distribution</a></li>
<li><a href="5-3-gaussian-model-of-height.html#sampling-from-the-posterior"><span class="toc-section-number">5.3.4</span> Sampling from the posterior</a></li>
<li><a href="5-3-gaussian-model-of-height.html#finding-the-posterior-distribution-with-quap"><span class="toc-section-number">5.3.5</span> Finding the posterior distribution with <code>quap</code></a></li>
<li><a href="5-3-gaussian-model-of-height.html#sampling-from-a-quap"><span class="toc-section-number">5.3.6</span> 4.3.6. Sampling from a <code>quap</code></a></li>
</ul></li>
<li><a href="5-4-linear-prediction.html#linear-prediction"><span class="toc-section-number">5.4</span> 4.4. Linear prediction</a>
<ul>
<li><a href="5-4-linear-prediction.html#the-linear-model-strategy"><span class="toc-section-number">5.4.1</span> 4.14.1. The linear model strategy</a></li>
<li><a href="5-4-linear-prediction.html#finding-the-posterior-distribution"><span class="toc-section-number">5.4.2</span> 4.4.2. Finding the posterior distribution</a></li>
<li><a href="5-4-linear-prediction.html#interpreting-the-posterior-distribution"><span class="toc-section-number">5.4.3</span> 4.4.3. Interpreting the posterior distribution</a></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="homework-week-1" class="section level2 unnumbered">
<h2>Homework: week 1</h2>
<ol style="list-style-type: decimal">
<li>Suppose the globe tossing data (Chapter 2) had turned out ot be 4 water in 15 tosses. Construct the posterior distribution, using grid approximation. Use the same flat prior as in the book.</li>
</ol>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="homework-week-1.html#cb75-1" aria-hidden="true" tabindex="-1"></a>grid_size <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb75-2"><a href="homework-week-1.html#cb75-2" aria-hidden="true" tabindex="-1"></a>n_water <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb75-3"><a href="homework-week-1.html#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="homework-week-1.html#cb75-4" aria-hidden="true" tabindex="-1"></a>p_grid <span class="ot">=</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> grid_size)</span>
<span id="cb75-5"><a href="homework-week-1.html#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="homework-week-1.html#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co"># define prior</span></span>
<span id="cb75-7"><a href="homework-week-1.html#cb75-7" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, grid_size)</span>
<span id="cb75-8"><a href="homework-week-1.html#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="homework-week-1.html#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co"># compute likelihood at each value in grid</span></span>
<span id="cb75-10"><a href="homework-week-1.html#cb75-10" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">=</span> <span class="fu">dbinom</span>(n_water, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> p_grid)</span>
<span id="cb75-11"><a href="homework-week-1.html#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="homework-week-1.html#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="co"># compute product of likelihood and prior</span></span>
<span id="cb75-13"><a href="homework-week-1.html#cb75-13" aria-hidden="true" tabindex="-1"></a>unstd.posterior <span class="ot">=</span> likelihood <span class="sc">*</span> prior</span>
<span id="cb75-14"><a href="homework-week-1.html#cb75-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-15"><a href="homework-week-1.html#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="co"># standardise the posterior, so it susms to 1</span></span>
<span id="cb75-16"><a href="homework-week-1.html#cb75-16" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">=</span> unstd.posterior <span class="sc">/</span> <span class="fu">sum</span>(unstd.posterior)</span>
<span id="cb75-17"><a href="homework-week-1.html#cb75-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-18"><a href="homework-week-1.html#cb75-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb75-19"><a href="homework-week-1.html#cb75-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p_grid, posterior, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb75-20"><a href="homework-week-1.html#cb75-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;probability of water&quot;</span>,</span>
<span id="cb75-21"><a href="homework-week-1.html#cb75-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;posterior probability&quot;</span>)</span>
<span id="cb75-22"><a href="homework-week-1.html#cb75-22" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(grid_size)  </span></code></pre></div>
<p><img src="Statistical-Rethinking-notes_files/figure-html/unnamed-chunk-130-1.png" width="672"  /></p>
<ol start="2" style="list-style-type: decimal">
<li>Start over in 1, but now use a prior that is zero below <span class="math inline">\(p\)</span> = 0.5 and a constant above <span class="math inline">\(p\)</span> = 0.5. This corresponds to prior inforamtion that a majority of the Earthâ€™s surface is water. What difference does the better prior make?</li>
</ol>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="homework-week-1.html#cb76-1" aria-hidden="true" tabindex="-1"></a>grid_size <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb76-2"><a href="homework-week-1.html#cb76-2" aria-hidden="true" tabindex="-1"></a>n_water <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb76-3"><a href="homework-week-1.html#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="homework-week-1.html#cb76-4" aria-hidden="true" tabindex="-1"></a>p_grid <span class="ot">=</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> grid_size)</span>
<span id="cb76-5"><a href="homework-week-1.html#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="homework-week-1.html#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co"># define prior</span></span>
<span id="cb76-7"><a href="homework-week-1.html#cb76-7" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">=</span> <span class="fu">ifelse</span>(p_grid <span class="sc">&lt;</span> .<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb76-8"><a href="homework-week-1.html#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="homework-week-1.html#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="co"># compute likelihood at each value in grid</span></span>
<span id="cb76-10"><a href="homework-week-1.html#cb76-10" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">=</span> <span class="fu">dbinom</span>(n_water, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> p_grid)</span>
<span id="cb76-11"><a href="homework-week-1.html#cb76-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-12"><a href="homework-week-1.html#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="co"># compute product of likelihood and prior</span></span>
<span id="cb76-13"><a href="homework-week-1.html#cb76-13" aria-hidden="true" tabindex="-1"></a>unstd.posterior <span class="ot">=</span> likelihood <span class="sc">*</span> prior</span>
<span id="cb76-14"><a href="homework-week-1.html#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="homework-week-1.html#cb76-15" aria-hidden="true" tabindex="-1"></a><span class="co"># standardise the posterior, so it susms to 1</span></span>
<span id="cb76-16"><a href="homework-week-1.html#cb76-16" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">=</span> unstd.posterior <span class="sc">/</span> <span class="fu">sum</span>(unstd.posterior)</span>
<span id="cb76-17"><a href="homework-week-1.html#cb76-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-18"><a href="homework-week-1.html#cb76-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb76-19"><a href="homework-week-1.html#cb76-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p_grid, posterior, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb76-20"><a href="homework-week-1.html#cb76-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;probability of water&quot;</span>,</span>
<span id="cb76-21"><a href="homework-week-1.html#cb76-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;posterior probability&quot;</span>)</span>
<span id="cb76-22"><a href="homework-week-1.html#cb76-22" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(grid_size)  </span></code></pre></div>
<p><img src="Statistical-Rethinking-notes_files/figure-html/unnamed-chunk-131-1.png" width="672"  /></p>
<ol start="3" style="list-style-type: decimal">
<li>For the posterior distribution from <strong>2</strong>, compute 89% percentile and HPDI intervals. Compare the widths of these intervals. Which is wider? Why? If you had only the information in the interval, what might you misunderstand about the shape of the posterior distribution?</li>
</ol>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="homework-week-1.html#cb77-1" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">=</span> <span class="fu">sample</span>(p_grid, <span class="at">prob =</span> posterior, <span class="at">size =</span> <span class="fl">1e4</span>, <span class="at">replace =</span> T)</span>
<span id="cb77-2"><a href="homework-week-1.html#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="homework-week-1.html#cb77-3" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">PI</span>(samples)</span></code></pre></div>
<pre><code>##        5%       94% 
## 0.5085085 0.7497497</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="homework-week-1.html#cb79-1" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples)</span></code></pre></div>
<pre><code>##     |0.89     0.89| 
## 0.5005005 0.7097097</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="homework-week-1.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PI is wider, and neither tells you that the highest point is just after 50%.</span></span></code></pre></div>

</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="practice.html"><button class="btn btn-default">Previous</button></a>
<a href="4-setup.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
