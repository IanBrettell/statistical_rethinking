<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="4.3 Gaussian model of height | Notes for Statistical Rethinking 2nd ed. by Richard McElreath" />
<meta property="og:type" content="book" />






<meta name="date" content="2021-12-04" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="4.3 Gaussian model of height | Notes for Statistical Rethinking 2nd ed. by Richard McElreath">

<title>4.3 Gaussian model of height | Notes for Statistical Rethinking 2nd ed. by Richard McElreath</title>

<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#index">Index</a></li>
<li><a href="1-the-golem-of-prague.html#the-golem-of-prague"><span class="toc-section-number">1</span> The Golem of Prague</a></li>
<li class="has-sub"><a href="2-small-worlds-and-large-worlds.html#small-worlds-and-large-worlds"><span class="toc-section-number">2</span> Small Worlds and Large Worlds</a>
<ul>
<li><a href="2.1-the-garden-of-forking-data.html#the-garden-of-forking-data"><span class="toc-section-number">2.1</span> The garden of forking data</a></li>
<li><a href="2.2-building-a-model.html#building-a-model"><span class="toc-section-number">2.2</span> Building a model</a></li>
<li><a href="2.3-components-of-the-model.html#components-of-the-model"><span class="toc-section-number">2.3</span> Components of the model</a></li>
<li class="has-sub"><a href="2.4-making-the-model-go.html#making-the-model-go"><span class="toc-section-number">2.4</span> Making the model go</a>
<ul>
<li><a href="2.4-making-the-model-go.html#markov-chain-monte-carlo"><span class="toc-section-number">2.4.1</span> Markov chain Monte Carlo</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="3-sampling-from-the-imaginary.html#sampling-from-the-imaginary"><span class="toc-section-number">3</span> Sampling from the Imaginary</a>
<ul>
<li><a href="3.1-sampling-from-a-grid-approximate-posterior.html#sampling-from-a-grid-approximate-posterior"><span class="toc-section-number">3.1</span> Sampling from a grid-approximate posterior</a></li>
<li><a href="3.2-sampling-to-summarize.html#sampling-to-summarize"><span class="toc-section-number">3.2</span> Sampling to summarize</a></li>
<li><a href="3.3-sampling-to-simulate-prediction.html#sampling-to-simulate-prediction"><span class="toc-section-number">3.3</span> Sampling to simulate prediction</a></li>
<li><a href="3.4-lets-practice-with-brms.html#lets-practice-with-brms"><span class="toc-section-number">3.4</span> Let’s practice with brms</a></li>
<li><a href="practice.html#practice">Practice</a></li>
<li><a href="homework-week-1.html#homework-week-1">Homework: week 1</a></li>
</ul></li>
<li class="has-sub"><a href="4-geocentric-models.html#geocentric-models"><span class="toc-section-number">4</span> Geocentric Models</a>
<ul>
<li><a href="4.1-why-normal-distributions-are-normal.html#why-normal-distributions-are-normal"><span class="toc-section-number">4.1</span> Why normal distributions are normal</a></li>
<li><a href="4.2-a-language-for-describing-models.html#a-language-for-describing-models"><span class="toc-section-number">4.2</span> A language for describing models</a></li>
<li><a href="4.3-gaussian-model-of-height.html#gaussian-model-of-height"><span class="toc-section-number">4.3</span> Gaussian model of height</a></li>
<li><a href="4.4-linear-prediction.html#linear-prediction"><span class="toc-section-number">4.4</span> Linear prediction</a></li>
<li><a href="4.5-curves-from-lines.html#curves-from-lines"><span class="toc-section-number">4.5</span> Curves from lines</a></li>
<li><a href="4.6-practice-1.html#practice-1"><span class="toc-section-number">4.6</span> Practice</a></li>
</ul></li>
<li class="has-sub"><a href="5-the-many-variables-the-spurious-waffles.html#the-many-variables-the-spurious-waffles"><span class="toc-section-number">5</span> The Many Variables &amp; The Spurious Waffles</a>
<ul>
<li><a href="5.1-spurious-association.html#spurious-association"><span class="toc-section-number">5.1</span> Spurious association</a></li>
<li><a href="5.2-masked-relationship.html#masked-relationship"><span class="toc-section-number">5.2</span> Masked relationship</a></li>
<li><a href="5.3-categorical-variables.html#categorical-variables"><span class="toc-section-number">5.3</span> Categorical variables</a></li>
<li><a href="5.4-practice-2.html#practice-2"><span class="toc-section-number">5.4</span> Practice</a></li>
</ul></li>
<li class="has-sub"><a href="6-the-haunted-dag-the-causal-terror.html#the-haunted-dag-the-causal-terror"><span class="toc-section-number">6</span> The Haunted DAG &amp; The Causal Terror</a>
<ul>
<li><a href="6.1-multicollinearity.html#multicollinearity"><span class="toc-section-number">6.1</span> Multicollinearity</a></li>
<li><a href="6.2-post-treatment-bias.html#post-treatment-bias"><span class="toc-section-number">6.2</span> Post-treatment bias</a></li>
<li><a href="6.3-collider-bias.html#collider-bias"><span class="toc-section-number">6.3</span> Collider bias</a></li>
<li><a href="6.4-confronting-confounding.html#confronting-confounding"><span class="toc-section-number">6.4</span> Confronting confounding</a></li>
<li><a href="6.5-summary.html#summary"><span class="toc-section-number">6.5</span> Summary</a></li>
<li><a href="6.6-practice-3.html#practice-3"><span class="toc-section-number">6.6</span> Practice</a></li>
</ul></li>
<li class="has-sub"><a href="7-ulysses-compass.html#ulysses-compass"><span class="toc-section-number">7</span> Ulysses’ Compass</a>
<ul>
<li><a href="7.1-the-problem-with-parameters.html#the-problem-with-parameters"><span class="toc-section-number">7.1</span> The problem with parameters</a></li>
<li><a href="7.2-entropy-and-accuracy.html#entropy-and-accuracy"><span class="toc-section-number">7.2</span> Entropy and accuracy</a></li>
<li><a href="7.3-golem-taming-regularization.html#golem-taming-regularization"><span class="toc-section-number">7.3</span> Golem taming: regularization</a></li>
<li><a href="7.4-predicting-predictive-accuracy.html#predicting-predictive-accuracy"><span class="toc-section-number">7.4</span> Predicting predictive accuracy</a></li>
<li><a href="7.5-model-comparison.html#model-comparison"><span class="toc-section-number">7.5</span> Model comparison</a></li>
<li><a href="7.6-practice-4.html#practice-4"><span class="toc-section-number">7.6</span> Practice</a></li>
</ul></li>
<li class="has-sub"><a href="8-conditional-manatees.html#conditional-manatees"><span class="toc-section-number">8</span> Conditional Manatees</a>
<ul>
<li><a href="8.1-building-an-interaction.html#building-an-interaction"><span class="toc-section-number">8.1</span> Building an interaction</a></li>
<li><a href="8.2-symmetry-of-interactions.html#symmetry-of-interactions"><span class="toc-section-number">8.2</span> Symmetry of interactions</a></li>
<li><a href="8.3-continuous-interactions.html#continuous-interactions"><span class="toc-section-number">8.3</span> Continuous interactions</a></li>
</ul></li>
<li class="has-sub"><a href="9-markov-chain-monte-carlo-1.html#markov-chain-monte-carlo-1"><span class="toc-section-number">9</span> Markov Chain Monte Carlo</a>
<ul>
<li><a href="9.1-good-king-markov-and-his-island-kingdom.html#good-king-markov-and-his-island-kingdom"><span class="toc-section-number">9.1</span> Good King Markov and his island kingdom</a></li>
<li><a href="9.2-metropolis-algorithm.html#metropolis-algorithm"><span class="toc-section-number">9.2</span> Metropolis algorithm</a></li>
<li><a href="9.3-hamiltonian-monte-carlo.html#hamiltonian-monte-carlo"><span class="toc-section-number">9.3</span> Hamiltonian Monte Carlo</a></li>
<li><a href="9.4-easy-hmc-ulam.html#easy-hmc-ulam"><span class="toc-section-number">9.4</span> Easy HMC: <code>ulam</code></a></li>
<li><a href="9.5-care-and-feeding-of-your-markov-chain.html#care-and-feeding-of-your-markov-chain"><span class="toc-section-number">9.5</span> Care and feeding of your Markov chain</a></li>
</ul></li>
<li class="has-sub"><a href="10-big-entropy-and-the-generalized-linear-model.html#big-entropy-and-the-generalized-linear-model"><span class="toc-section-number">10</span> Big Entropy and the Generalized Linear Model</a>
<ul>
<li><a href="10.1-maximum-entropy.html#maximum-entropy"><span class="toc-section-number">10.1</span> Maximum entropy</a></li>
<li><a href="10.2-generalized-linear-models.html#generalized-linear-models"><span class="toc-section-number">10.2</span> Generalized linear models</a></li>
</ul></li>
<li class="has-sub"><a href="11-god-spiked-the-integers.html#god-spiked-the-integers"><span class="toc-section-number">11</span> God Spiked the Integers</a>
<ul>
<li><a href="11.1-binomial-regression.html#binomial-regression"><span class="toc-section-number">11.1</span> Binomial regression</a></li>
<li><a href="11.2-poisson-regression.html#poisson-regression"><span class="toc-section-number">11.2</span> Poisson regression</a></li>
<li><a href="11.3-multinomial-and-categorical-models.html#multinomial-and-categorical-models"><span class="toc-section-number">11.3</span> Multinomial and categorical models</a></li>
</ul></li>
<li class="has-sub"><a href="12-models-with-memory.html#models-with-memory"><span class="toc-section-number">12</span> Models With Memory</a>
<ul>
<li><a href="12.1-example-multilevel-tadpoles.html#example-multilevel-tadpoles"><span class="toc-section-number">12.1</span> Example: Multilevel tadpoles</a></li>
<li><a href="12.2-varying-effects-and-the-underfittingoverfitting-trade-off.html#varying-effects-and-the-underfittingoverfitting-trade-off"><span class="toc-section-number">12.2</span> Varying effects and the underfitting/overfitting trade-off</a></li>
<li><a href="12.3-more-than-one-type-of-cluster.html#more-than-one-type-of-cluster"><span class="toc-section-number">12.3</span> More than one type of cluster</a></li>
<li><a href="12.4-divergent-transitions-and-non-centered-priors.html#divergent-transitions-and-non-centered-priors"><span class="toc-section-number">12.4</span> Divergent transitions and non-centered priors</a></li>
<li><a href="12.5-multilevel-posterior-predictions.html#multilevel-posterior-predictions"><span class="toc-section-number">12.5</span> Multilevel posterior predictions</a></li>
</ul></li>
<li class="has-sub"><a href="13-adventures-in-covariance.html#adventures-in-covariance"><span class="toc-section-number">13</span> Adventures in Covariance</a>
<ul>
<li><a href="13.1-varying-slopes-by-construction.html#varying-slopes-by-construction"><span class="toc-section-number">13.1</span> Varying slopes by construction</a></li>
<li><a href="13.2-advanced-varying-slopes.html#advanced-varying-slopes"><span class="toc-section-number">13.2</span> Advanced varying slopes</a></li>
<li><a href="13.3-instruments-and-causal-designs.html#instruments-and-causal-designs"><span class="toc-section-number">13.3</span> Instruments and causal designs</a></li>
<li><a href="13.4-social-relations-as-correlated-varying-effects.html#social-relations-as-correlated-varying-effects"><span class="toc-section-number">13.4</span> Social relations as correlated varying effects</a></li>
<li><a href="13.5-continuous-categories-and-the-gaussian-process.html#continuous-categories-and-the-gaussian-process"><span class="toc-section-number">13.5</span> Continuous categories and the Gaussian process</a></li>
<li><a href="13.6-bonus-multilevel-growth-models-and-the-melsm.html#bonus-multilevel-growth-models-and-the-melsm"><span class="toc-section-number">13.6</span> Bonus: Multilevel growth models and the MELSM</a></li>
</ul></li>
<li class="has-sub"><a href="14-missing-data-and-other-opportunities.html#missing-data-and-other-opportunities"><span class="toc-section-number">14</span> Missing Data and Other Opportunities</a>
<ul>
<li><a href="14.1-measurement-error.html#measurement-error"><span class="toc-section-number">14.1</span> Measurement error</a></li>
<li><a href="14.2-missing-data.html#missing-data"><span class="toc-section-number">14.2</span> Missing data</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="gaussian-model-of-height" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Gaussian model of height</h2>
<p>Before we add a predictor variable, we want to model the outcome variable as a Gaussian distribution. There are an infinite number of possible Gaussian distributions based on infinite combinations of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>. We want our Bayesian machine to consider every possible distribution, and rank them by posterior plausibility.</p>
<p><strong><em>4.3.1 The data</em></strong></p>
<div class="figure">
<img src="slides/L03/23.png" alt="These height data come from Nancy Howell's data. `Howell1` is a simplified dataset. We'll focus just on adult heights at the moment. " width="80%" />
<p class="caption marginnote shownote">
These height data come from Nancy Howell’s data. <code>Howell1</code> is a simplified dataset. We’ll focus just on adult heights at the moment.
</p>
</div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="4.3-gaussian-model-of-height.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Howell1)</span>
<span id="cb125-2"><a href="4.3-gaussian-model-of-height.html#cb125-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> Howell1</span></code></pre></div>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="4.3-gaussian-model-of-height.html#cb126-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb126-2"><a href="4.3-gaussian-model-of-height.html#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>()</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    544 obs. of  4 variables:
##  $ height: num  152 140 137 157 145 ...
##  $ weight: num  47.8 36.5 31.9 53 41.3 ...
##  $ age   : num  63 63 65 41 51 35 32 27 19 54 ...
##  $ male  : int  1 0 0 1 0 1 0 1 0 1 ...</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="4.3-gaussian-model-of-height.html#cb128-1" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">precis</span>(d)</span></code></pre></div>
<pre><code>##               mean         sd      5.5%     94.5%     histogram
## height 138.2635963 27.6024476 81.108550 165.73500 ▁▁▁▁▁▁▁▂▁▇▇▅▁
## weight  35.6106176 14.7191782  9.360721  54.50289 ▁▂▃▂▂▂▂▅▇▇▃▂▁
## age     29.3443934 20.7468882  1.000000  66.13500     ▇▅▅▃▅▂▂▁▁
## male     0.4724265  0.4996986  0.000000   1.00000    ▇▁▁▁▁▁▁▁▁▇</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="4.3-gaussian-model-of-height.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d<span class="sc">$</span>height)</span></code></pre></div>
<pre><code>## [1] 151.765 139.700 136.525 156.845 145.415 163.830</code></pre>
<p>Filter for adults:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="4.3-gaussian-model-of-height.html#cb132-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">=</span> d[d<span class="sc">$</span>age <span class="sc">&gt;=</span> <span class="dv">18</span>, ]</span></code></pre></div>
<p><strong><em>4.3.2 The model</em></strong></p>
<div class="figure">
<img src="slides/L03/24.png" alt="Here's the distribution of height data. $h$ is distributed normally." width="80%" />
<p class="caption marginnote shownote">
Here’s the distribution of height data. <span class="math inline">\(h\)</span> is distributed normally.
</p>
</div>
<div class="figure">
<img src="slides/L03/25.png" alt="There's nothing special about the particular letters used. But it's important to be able to read this. Now we have three variables. One is observed, and two have not. We have to infrer them from $h$." width="80%" />
<p class="caption marginnote shownote">
There’s nothing special about the particular letters used. But it’s important to be able to read this. Now we have three variables. One is observed, and two have not. We have to infrer them from <span class="math inline">\(h\)</span>.
</p>
</div>
<div class="figure">
<img src="slides/L03/26.png" alt="Because this is Bayesian, they have prior distributions. Using 187 cm (height of Richard) as the prior. Standard deviation is on the mean. 20 is very generous. Then for sigma, uniform 50. " width="80%" />
<p class="caption marginnote shownote">
Because this is Bayesian, they have prior distributions. Using 187 cm (height of Richard) as the prior. Standard deviation is on the mean. 20 is very generous. Then for sigma, uniform 50.
</p>
</div>
<p>Whatever the prior, it’s a very good idea to plot your priors:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="4.3-gaussian-model-of-height.html#cb133-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb133-2"><a href="4.3-gaussian-model-of-height.html#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">100</span>, <span class="at">to =</span> <span class="dv">250</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb133-3"><a href="4.3-gaussian-model-of-height.html#cb133-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb133-4"><a href="4.3-gaussian-model-of-height.html#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">178</span>, <span class="at">sd =</span> <span class="dv">20</span>))) <span class="sc">+</span></span>
<span id="cb133-5"><a href="4.3-gaussian-model-of-height.html#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb133-6"><a href="4.3-gaussian-model-of-height.html#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">100</span>, <span class="at">to =</span> <span class="dv">250</span>, <span class="at">by =</span> <span class="dv">75</span>)) <span class="sc">+</span></span>
<span id="cb133-7"><a href="4.3-gaussian-model-of-height.html#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;mu ~ dnorm(178, 20)&quot;</span>,</span>
<span id="cb133-8"><a href="4.3-gaussian-model-of-height.html#cb133-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>)</span>
<span id="cb133-9"><a href="4.3-gaussian-model-of-height.html#cb133-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-10"><a href="4.3-gaussian-model-of-height.html#cb133-10" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="04_geocentric_models_files/figure-html/4.12-1.png" width="672" /></p>
<p>The <span class="math inline">\(\sigma\)</span> prior is a truly flat prior.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="4.3-gaussian-model-of-height.html#cb134-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb134-2"><a href="4.3-gaussian-model-of-height.html#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb134-3"><a href="4.3-gaussian-model-of-height.html#cb134-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb134-4"><a href="4.3-gaussian-model-of-height.html#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">dunif</span>(x, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">50</span>))) <span class="sc">+</span></span>
<span id="cb134-5"><a href="4.3-gaussian-model-of-height.html#cb134-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb134-6"><a href="4.3-gaussian-model-of-height.html#cb134-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb134-7"><a href="4.3-gaussian-model-of-height.html#cb134-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb134-8"><a href="4.3-gaussian-model-of-height.html#cb134-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;sigma ~ dunif(0, 50)&quot;</span>)</span>
<span id="cb134-9"><a href="4.3-gaussian-model-of-height.html#cb134-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-10"><a href="4.3-gaussian-model-of-height.html#cb134-10" aria-hidden="true" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="04_geocentric_models_files/figure-html/4.13-1.png" width="672" /></p>
<p>A standard deviation like <span class="math inline">\(\sigma\)</span> must be positive, so bounding it at zero makes sense.</p>
<div class="figure">
<img src="slides/L03/27.png" alt="Before your model has seen the data. This is not p-hacking, because we're not using the data. We're using scientific information. All you have to sample values." width="80%" />
<p class="caption marginnote shownote">
Before your model has seen the data. This is not p-hacking, because we’re not using the data. We’re using scientific information. All you have to sample values.
</p>
</div>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="4.3-gaussian-model-of-height.html#cb135-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb135-2"><a href="4.3-gaussian-model-of-height.html#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="4.3-gaussian-model-of-height.html#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb135-4"><a href="4.3-gaussian-model-of-height.html#cb135-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-5"><a href="4.3-gaussian-model-of-height.html#cb135-5" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span></span>
<span id="cb135-6"><a href="4.3-gaussian-model-of-height.html#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">sample_mu    =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">178</span>, <span class="at">sd  =</span> <span class="dv">20</span>),</span>
<span id="cb135-7"><a href="4.3-gaussian-model-of-height.html#cb135-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">sample_sigma =</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">50</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb135-8"><a href="4.3-gaussian-model-of-height.html#cb135-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">height =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> sample_mu, <span class="at">sd =</span> sample_sigma))</span>
<span id="cb135-9"><a href="4.3-gaussian-model-of-height.html#cb135-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-10"><a href="4.3-gaussian-model-of-height.html#cb135-10" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> sim <span class="sc">%&gt;%</span> </span>
<span id="cb135-11"><a href="4.3-gaussian-model-of-height.html#cb135-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb135-12"><a href="4.3-gaussian-model-of-height.html#cb135-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;grey33&quot;</span>) <span class="sc">+</span></span>
<span id="cb135-13"><a href="4.3-gaussian-model-of-height.html#cb135-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">73</span>, <span class="dv">178</span>, <span class="dv">283</span>)) <span class="sc">+</span></span>
<span id="cb135-14"><a href="4.3-gaussian-model-of-height.html#cb135-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb135-15"><a href="4.3-gaussian-model-of-height.html#cb135-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;height ~ dnorm(mu, sigma)&quot;</span>) <span class="sc">+</span></span>
<span id="cb135-16"><a href="4.3-gaussian-model-of-height.html#cb135-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb135-17"><a href="4.3-gaussian-model-of-height.html#cb135-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-18"><a href="4.3-gaussian-model-of-height.html#cb135-18" aria-hidden="true" tabindex="-1"></a>p3</span></code></pre></div>
<p><img src="04_geocentric_models_files/figure-html/4.14-1.png" width="672" /></p>
<p>This is not a normal distribution. It’s a t-distribution because you have uncertainty about variance, which gives it fat tails. There are some really really tall individuals in this prior. But at least we don’t have any negative heights.</p>
<p>Let’s see the implied heights with a flatter and less informative prior for <span class="math inline">\(\mu\)</span>.:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="4.3-gaussian-model-of-height.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate</span></span>
<span id="cb136-2"><a href="4.3-gaussian-model-of-height.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb136-3"><a href="4.3-gaussian-model-of-height.html#cb136-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-4"><a href="4.3-gaussian-model-of-height.html#cb136-4" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span></span>
<span id="cb136-5"><a href="4.3-gaussian-model-of-height.html#cb136-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">sample_mu    =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">178</span>, <span class="at">sd =</span> <span class="dv">100</span>),</span>
<span id="cb136-6"><a href="4.3-gaussian-model-of-height.html#cb136-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">sample_sigma =</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">50</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb136-7"><a href="4.3-gaussian-model-of-height.html#cb136-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">height =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> sample_mu, <span class="at">sd =</span> sample_sigma))</span>
<span id="cb136-8"><a href="4.3-gaussian-model-of-height.html#cb136-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-9"><a href="4.3-gaussian-model-of-height.html#cb136-9" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the values we&#39;ll use to break on our x axis</span></span>
<span id="cb136-10"><a href="4.3-gaussian-model-of-height.html#cb136-10" aria-hidden="true" tabindex="-1"></a>breaks <span class="ot">&lt;-</span></span>
<span id="cb136-11"><a href="4.3-gaussian-model-of-height.html#cb136-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">mean</span>(sim<span class="sc">$</span>height) <span class="sc">-</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">sd</span>(sim<span class="sc">$</span>height), <span class="dv">0</span>, <span class="fu">mean</span>(sim<span class="sc">$</span>height), <span class="fu">mean</span>(sim<span class="sc">$</span>height) <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">sd</span>(sim<span class="sc">$</span>height)) <span class="sc">%&gt;%</span> </span>
<span id="cb136-12"><a href="4.3-gaussian-model-of-height.html#cb136-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb136-13"><a href="4.3-gaussian-model-of-height.html#cb136-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-14"><a href="4.3-gaussian-model-of-height.html#cb136-14" aria-hidden="true" tabindex="-1"></a><span class="co"># this is just for aesthetics</span></span>
<span id="cb136-15"><a href="4.3-gaussian-model-of-height.html#cb136-15" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb136-16"><a href="4.3-gaussian-model-of-height.html#cb136-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">height =</span> <span class="dv">272</span> <span class="sc">-</span> <span class="dv">25</span>,</span>
<span id="cb136-17"><a href="4.3-gaussian-model-of-height.html#cb136-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">y      =</span> .<span class="dv">0013</span>,</span>
<span id="cb136-18"><a href="4.3-gaussian-model-of-height.html#cb136-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">label  =</span> <span class="st">&quot;tallest man&quot;</span>,</span>
<span id="cb136-19"><a href="4.3-gaussian-model-of-height.html#cb136-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">angle  =</span> <span class="dv">90</span>)</span>
<span id="cb136-20"><a href="4.3-gaussian-model-of-height.html#cb136-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-21"><a href="4.3-gaussian-model-of-height.html#cb136-21" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb136-22"><a href="4.3-gaussian-model-of-height.html#cb136-22" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb136-23"><a href="4.3-gaussian-model-of-height.html#cb136-23" aria-hidden="true" tabindex="-1"></a>  sim <span class="sc">%&gt;%</span> </span>
<span id="cb136-24"><a href="4.3-gaussian-model-of-height.html#cb136-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb136-25"><a href="4.3-gaussian-model-of-height.html#cb136-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb136-26"><a href="4.3-gaussian-model-of-height.html#cb136-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="sc">+</span></span>
<span id="cb136-27"><a href="4.3-gaussian-model-of-height.html#cb136-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">272</span>, <span class="at">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb136-28"><a href="4.3-gaussian-model-of-height.html#cb136-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb136-29"><a href="4.3-gaussian-model-of-height.html#cb136-29" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">label =</span> label, <span class="at">angle =</span> angle),</span>
<span id="cb136-30"><a href="4.3-gaussian-model-of-height.html#cb136-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="sc">+</span></span>
<span id="cb136-31"><a href="4.3-gaussian-model-of-height.html#cb136-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> breaks) <span class="sc">+</span></span>
<span id="cb136-32"><a href="4.3-gaussian-model-of-height.html#cb136-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb136-33"><a href="4.3-gaussian-model-of-height.html#cb136-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;height ~ dnorm(mu, sigma)</span><span class="sc">\n</span><span class="st">mu ~ dnorm(178, 100)&quot;</span>) <span class="sc">+</span></span>
<span id="cb136-34"><a href="4.3-gaussian-model-of-height.html#cb136-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb136-35"><a href="4.3-gaussian-model-of-height.html#cb136-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-36"><a href="4.3-gaussian-model-of-height.html#cb136-36" aria-hidden="true" tabindex="-1"></a>p4</span></code></pre></div>
<p><img src="04_geocentric_models_files/figure-html/4.15-1.png" width="672" /></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="4.3-gaussian-model-of-height.html#cb137-1" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;mu&quot;</span>) <span class="sc">|</span> p2 <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;sigma&quot;</span>)) <span class="sc">/</span> (p3 <span class="sc">|</span> p4)</span></code></pre></div>
<p><img src="04_geocentric_models_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>Before it even sees the data, it expects 4% of people to have negative height, and also some giants. Does it matter? In this case we have so much data that the silly prior is harmless. But that won’t always be the case. There are plenty of inference problems for which the data alone are not sufficient, no matter how numerous. Bayes lets us proceed in these cases, but only if we use our scientific knowledge to construct sensible priors. <em>The important thing is that your prior not be based on the values in the data, but only on what you know about the data before you see it.</em></p>
<p>Let’s use a different prior.</p>
<div class="figure">
<img src="slides/L03/28.png" alt="Typical linear regression priors are flat. They're bad new because they create impossible outcomes before you even see the data." width="80%" />
<p class="caption marginnote shownote">
Typical linear regression priors are flat. They’re bad new because they create impossible outcomes before you even see the data.
</p>
</div>
<p><strong><em>4.3.3 Grid approximation of the posterior distribution</em></strong></p>
<div class="figure">
<img src="slides/L03/29.png" alt="Once you start working with mixed models, the priors have a greater effect, so it's good to get used to prior predictive simulation now. We'll calculate the grid and the posterior probability. How? Multiply the observed height conditional on the mu and sigma at that point. Times the prior probability of that mu and sigma. They code to do this is some loops. " width="80%" />
<p class="caption marginnote shownote">
Once you start working with mixed models, the priors have a greater effect, so it’s good to get used to prior predictive simulation now. We’ll calculate the grid and the posterior probability. How? Multiply the observed height conditional on the mu and sigma at that point. Times the prior probability of that mu and sigma. They code to do this is some loops.
</p>
</div>
<div class="figure">
<img src="slides/L03/30.png" alt="100x100 you start to see the Gaussian hill. Gradually the values become increasingly implausible. What we do here is draw samples." width="80%" />
<p class="caption marginnote shownote">
100x100 you start to see the Gaussian hill. Gradually the values become increasingly implausible. What we do here is draw samples.
</p>
</div>
<p>Here are the guts of the golem:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="4.3-gaussian-model-of-height.html#cb138-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> </span>
<span id="cb138-2"><a href="4.3-gaussian-model-of-height.html#cb138-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb138-3"><a href="4.3-gaussian-model-of-height.html#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">&gt;=</span> <span class="dv">18</span>)</span>
<span id="cb138-4"><a href="4.3-gaussian-model-of-height.html#cb138-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-5"><a href="4.3-gaussian-model-of-height.html#cb138-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb138-6"><a href="4.3-gaussian-model-of-height.html#cb138-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-7"><a href="4.3-gaussian-model-of-height.html#cb138-7" aria-hidden="true" tabindex="-1"></a>d_grid <span class="ot">&lt;-</span></span>
<span id="cb138-8"><a href="4.3-gaussian-model-of-height.html#cb138-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we&#39;ll accomplish with `tidyr::crossing()` what McElreath did with base R `expand.grid()`</span></span>
<span id="cb138-9"><a href="4.3-gaussian-model-of-height.html#cb138-9" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">crossing</span>(<span class="at">mu    =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">140</span>, <span class="at">to =</span> <span class="dv">160</span>, <span class="at">length.out =</span> n),</span>
<span id="cb138-10"><a href="4.3-gaussian-model-of-height.html#cb138-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sigma =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">4</span>, <span class="at">to =</span> <span class="dv">9</span>, <span class="at">length.out =</span> n))</span>
<span id="cb138-11"><a href="4.3-gaussian-model-of-height.html#cb138-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-12"><a href="4.3-gaussian-model-of-height.html#cb138-12" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(d_grid)</span></code></pre></div>
<pre><code>## Rows: 40,000
## Columns: 2
## $ mu    &lt;dbl&gt; 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140,…
## $ sigma &lt;dbl&gt; 4.000000, 4.025126, 4.050251, 4.075377, 4.100503, 4.125628, 4.15…</code></pre>
<p><code>d_grid</code> contains every combination of <code>mu</code> and <code>sigma</code> across their specified values.</p>
<p>Create custom function:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="4.3-gaussian-model-of-height.html#cb140-1" aria-hidden="true" tabindex="-1"></a>grid_function <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma) {</span>
<span id="cb140-2"><a href="4.3-gaussian-model-of-height.html#cb140-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-3"><a href="4.3-gaussian-model-of-height.html#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dnorm</span>(d2<span class="sc">$</span>height, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma, <span class="at">log =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb140-4"><a href="4.3-gaussian-model-of-height.html#cb140-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>()</span>
<span id="cb140-5"><a href="4.3-gaussian-model-of-height.html#cb140-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-6"><a href="4.3-gaussian-model-of-height.html#cb140-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="4.3-gaussian-model-of-height.html#cb141-1" aria-hidden="true" tabindex="-1"></a>d_grid <span class="ot">&lt;-</span></span>
<span id="cb141-2"><a href="4.3-gaussian-model-of-height.html#cb141-2" aria-hidden="true" tabindex="-1"></a>  d_grid <span class="sc">%&gt;%</span> </span>
<span id="cb141-3"><a href="4.3-gaussian-model-of-height.html#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_likelihood =</span> purrr<span class="sc">::</span><span class="fu">map2</span>(mu, sigma, grid_function)) <span class="sc">%&gt;%</span></span>
<span id="cb141-4"><a href="4.3-gaussian-model-of-height.html#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(log_likelihood) <span class="sc">%&gt;%</span> </span>
<span id="cb141-5"><a href="4.3-gaussian-model-of-height.html#cb141-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prior_mu    =</span> <span class="fu">dnorm</span>(mu, <span class="at">mean =</span> <span class="dv">178</span>, <span class="at">sd =</span> <span class="dv">20</span>, <span class="at">log =</span> T),</span>
<span id="cb141-6"><a href="4.3-gaussian-model-of-height.html#cb141-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">prior_sigma =</span> <span class="fu">dunif</span>(sigma, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">50</span>, <span class="at">log =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb141-7"><a href="4.3-gaussian-model-of-height.html#cb141-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product =</span> log_likelihood <span class="sc">+</span> prior_mu <span class="sc">+</span> prior_sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb141-8"><a href="4.3-gaussian-model-of-height.html#cb141-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">probability =</span> <span class="fu">exp</span>(product <span class="sc">-</span> <span class="fu">max</span>(product)))</span>
<span id="cb141-9"><a href="4.3-gaussian-model-of-height.html#cb141-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-10"><a href="4.3-gaussian-model-of-height.html#cb141-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d_grid)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
##      mu sigma log_likelihood prior_mu prior_sigma product probability
##   &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;
## 1   140  4            -3813.    -5.72       -3.91  -3822.           0
## 2   140  4.03         -3778.    -5.72       -3.91  -3787.           0
## 3   140  4.05         -3743.    -5.72       -3.91  -3753.           0
## 4   140  4.08         -3709.    -5.72       -3.91  -3719.           0
## 5   140  4.10         -3676.    -5.72       -3.91  -3686.           0
## 6   140  4.13         -3644.    -5.72       -3.91  -3653.           0</code></pre>
<p>Inspect the posterior distribution</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="4.3-gaussian-model-of-height.html#cb143-1" aria-hidden="true" tabindex="-1"></a>d_grid <span class="sc">%&gt;%</span> </span>
<span id="cb143-2"><a href="4.3-gaussian-model-of-height.html#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mu, <span class="at">y =</span> sigma, <span class="at">z =</span> probability)) <span class="sc">+</span> </span>
<span id="cb143-3"><a href="4.3-gaussian-model-of-height.html#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>() <span class="sc">+</span></span>
<span id="cb143-4"><a href="4.3-gaussian-model-of-height.html#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(mu),</span>
<span id="cb143-5"><a href="4.3-gaussian-model-of-height.html#cb143-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(sigma)) <span class="sc">+</span></span>
<span id="cb143-6"><a href="4.3-gaussian-model-of-height.html#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(d_grid<span class="sc">$</span>mu),</span>
<span id="cb143-7"><a href="4.3-gaussian-model-of-height.html#cb143-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(d_grid<span class="sc">$</span>sigma)) <span class="sc">+</span></span>
<span id="cb143-8"><a href="4.3-gaussian-model-of-height.html#cb143-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="04_geocentric_models_files/figure-html/4.17-1.png" width="672" /></p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="4.3-gaussian-model-of-height.html#cb144-1" aria-hidden="true" tabindex="-1"></a>d_grid <span class="sc">%&gt;%</span> </span>
<span id="cb144-2"><a href="4.3-gaussian-model-of-height.html#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mu, <span class="at">y =</span> sigma, <span class="at">fill =</span> probability)) <span class="sc">+</span> </span>
<span id="cb144-3"><a href="4.3-gaussian-model-of-height.html#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="at">interpolate =</span> T) <span class="sc">+</span></span>
<span id="cb144-4"><a href="4.3-gaussian-model-of-height.html#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;B&quot;</span>) <span class="sc">+</span></span>
<span id="cb144-5"><a href="4.3-gaussian-model-of-height.html#cb144-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(mu),</span>
<span id="cb144-6"><a href="4.3-gaussian-model-of-height.html#cb144-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(sigma)) <span class="sc">+</span></span>
<span id="cb144-7"><a href="4.3-gaussian-model-of-height.html#cb144-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="04_geocentric_models_files/figure-html/4.18-1.png" width="672" /></p>
<p><strong><em>4.3.4 Sampling from the posterior</em></strong></p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="4.3-gaussian-model-of-height.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb145-2"><a href="4.3-gaussian-model-of-height.html#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="4.3-gaussian-model-of-height.html#cb145-3" aria-hidden="true" tabindex="-1"></a>d_grid_samples <span class="ot">&lt;-</span> </span>
<span id="cb145-4"><a href="4.3-gaussian-model-of-height.html#cb145-4" aria-hidden="true" tabindex="-1"></a>  d_grid <span class="sc">%&gt;%</span> </span>
<span id="cb145-5"><a href="4.3-gaussian-model-of-height.html#cb145-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="at">size =</span> <span class="fl">1e4</span>, <span class="at">replace =</span> T, <span class="at">weight =</span> probability)</span>
<span id="cb145-6"><a href="4.3-gaussian-model-of-height.html#cb145-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-7"><a href="4.3-gaussian-model-of-height.html#cb145-7" aria-hidden="true" tabindex="-1"></a>d_grid_samples <span class="sc">%&gt;%</span> </span>
<span id="cb145-8"><a href="4.3-gaussian-model-of-height.html#cb145-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mu, <span class="at">y =</span> sigma)) <span class="sc">+</span> </span>
<span id="cb145-9"><a href="4.3-gaussian-model-of-height.html#cb145-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> .<span class="dv">9</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb145-10"><a href="4.3-gaussian-model-of-height.html#cb145-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb145-11"><a href="4.3-gaussian-model-of-height.html#cb145-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(mu[samples]),</span>
<span id="cb145-12"><a href="4.3-gaussian-model-of-height.html#cb145-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(sigma[samples])) <span class="sc">+</span></span>
<span id="cb145-13"><a href="4.3-gaussian-model-of-height.html#cb145-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="04_geocentric_models_files/figure-html/4.19-1.png" width="672" /></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="4.3-gaussian-model-of-height.html#cb146-1" aria-hidden="true" tabindex="-1"></a>d_grid_samples <span class="sc">%&gt;%</span> </span>
<span id="cb146-2"><a href="4.3-gaussian-model-of-height.html#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(mu<span class="sc">:</span>sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb146-3"><a href="4.3-gaussian-model-of-height.html#cb146-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-4"><a href="4.3-gaussian-model-of-height.html#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span> </span>
<span id="cb146-5"><a href="4.3-gaussian-model-of-height.html#cb146-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;grey33&quot;</span>) <span class="sc">+</span></span>
<span id="cb146-6"><a href="4.3-gaussian-model-of-height.html#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb146-7"><a href="4.3-gaussian-model-of-height.html#cb146-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb146-8"><a href="4.3-gaussian-model-of-height.html#cb146-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb146-9"><a href="4.3-gaussian-model-of-height.html#cb146-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">labeller =</span> label_parsed)</span></code></pre></div>
<p><img src="04_geocentric_models_files/figure-html/4.21-1.png" width="672" /></p>
<p>Summarise the widths:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="4.3-gaussian-model-of-height.html#cb147-1" aria-hidden="true" tabindex="-1"></a>d_grid_samples <span class="sc">%&gt;%</span> </span>
<span id="cb147-2"><a href="4.3-gaussian-model-of-height.html#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(mu<span class="sc">:</span>sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb147-3"><a href="4.3-gaussian-model-of-height.html#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb147-4"><a href="4.3-gaussian-model-of-height.html#cb147-4" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">mode_hdi</span>(value)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 7
##   name   value .lower .upper .width .point .interval
##   &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 mu    155.   154.   155.     0.95 mode   hdi      
## 2 sigma   7.82   7.14   8.30   0.95 mode   hdi</code></pre>
<div class="figure">
<img src="slides/L03/31.png" alt="Once you have the samples, you just work with the data frame. You can look at cross-sections of this." width="80%" />
<p class="caption marginnote shownote">
Once you have the samples, you just work with the data frame. You can look at cross-sections of this.
</p>
</div>
<p>Note that this isn’t perfectly symmetrical for sigma - the right tail is longer. This is almost always true for SD parameters. Why? Because you know something about the SD before you see the data: you know it’s positive. So you always have more uncertainty on the higher end.</p>
<p>Let’s analyze only 20 of the heights from the height data to reveal this issue.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="4.3-gaussian-model-of-height.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb149-2"><a href="4.3-gaussian-model-of-height.html#cb149-2" aria-hidden="true" tabindex="-1"></a>(d3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(d2<span class="sc">$</span>height, <span class="at">size =</span> <span class="dv">20</span>))</span></code></pre></div>
<pre><code>##  [1] 147.3200 154.9400 168.9100 156.8450 165.7350 151.7650 165.7350 156.2100
##  [9] 144.7800 154.9400 151.1300 147.9550 149.8600 162.5600 161.9250 164.4650
## [17] 160.9852 151.7650 163.8300 149.8600</code></pre>
<p>Now repeat the code from the previous subsection, modified to focus on the 20 heights in <code>d3</code> rather than the original data.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="4.3-gaussian-model-of-height.html#cb151-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb151-2"><a href="4.3-gaussian-model-of-height.html#cb151-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-3"><a href="4.3-gaussian-model-of-height.html#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="co"># note we&#39;ve redefined the ranges of `mu` and `sigma`</span></span>
<span id="cb151-4"><a href="4.3-gaussian-model-of-height.html#cb151-4" aria-hidden="true" tabindex="-1"></a>d_grid <span class="ot">&lt;-</span></span>
<span id="cb151-5"><a href="4.3-gaussian-model-of-height.html#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">mu    =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">150</span>, <span class="at">to =</span> <span class="dv">170</span>, <span class="at">length.out =</span> n),</span>
<span id="cb151-6"><a href="4.3-gaussian-model-of-height.html#cb151-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">sigma =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">4</span>, <span class="at">to =</span> <span class="dv">20</span>, <span class="at">length.out =</span> n))</span>
<span id="cb151-7"><a href="4.3-gaussian-model-of-height.html#cb151-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-8"><a href="4.3-gaussian-model-of-height.html#cb151-8" aria-hidden="true" tabindex="-1"></a><span class="co"># amend the grid function</span></span>
<span id="cb151-9"><a href="4.3-gaussian-model-of-height.html#cb151-9" aria-hidden="true" tabindex="-1"></a>grid_function <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma) {</span>
<span id="cb151-10"><a href="4.3-gaussian-model-of-height.html#cb151-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-11"><a href="4.3-gaussian-model-of-height.html#cb151-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dnorm</span>(d3, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma, <span class="at">log =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb151-12"><a href="4.3-gaussian-model-of-height.html#cb151-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>()</span>
<span id="cb151-13"><a href="4.3-gaussian-model-of-height.html#cb151-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-14"><a href="4.3-gaussian-model-of-height.html#cb151-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb151-15"><a href="4.3-gaussian-model-of-height.html#cb151-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-16"><a href="4.3-gaussian-model-of-height.html#cb151-16" aria-hidden="true" tabindex="-1"></a><span class="co"># make the posterior</span></span>
<span id="cb151-17"><a href="4.3-gaussian-model-of-height.html#cb151-17" aria-hidden="true" tabindex="-1"></a>d_grid <span class="ot">&lt;-</span></span>
<span id="cb151-18"><a href="4.3-gaussian-model-of-height.html#cb151-18" aria-hidden="true" tabindex="-1"></a>  d_grid <span class="sc">%&gt;%</span> </span>
<span id="cb151-19"><a href="4.3-gaussian-model-of-height.html#cb151-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_likelihood =</span> <span class="fu">map2_dbl</span>(mu, sigma, grid_function)) <span class="sc">%&gt;%</span> </span>
<span id="cb151-20"><a href="4.3-gaussian-model-of-height.html#cb151-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prior_mu    =</span> <span class="fu">dnorm</span>(mu, <span class="at">mean =</span> <span class="dv">178</span>, <span class="at">sd =</span> <span class="dv">20</span>, <span class="at">log =</span> T),</span>
<span id="cb151-21"><a href="4.3-gaussian-model-of-height.html#cb151-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">prior_sigma =</span> <span class="fu">dunif</span>(sigma, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">50</span>, <span class="at">log =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb151-22"><a href="4.3-gaussian-model-of-height.html#cb151-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product =</span> log_likelihood <span class="sc">+</span> prior_mu <span class="sc">+</span> prior_sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb151-23"><a href="4.3-gaussian-model-of-height.html#cb151-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">probability =</span> <span class="fu">exp</span>(product <span class="sc">-</span> <span class="fu">max</span>(product)))</span>
<span id="cb151-24"><a href="4.3-gaussian-model-of-height.html#cb151-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-25"><a href="4.3-gaussian-model-of-height.html#cb151-25" aria-hidden="true" tabindex="-1"></a><span class="co"># `sample_n()` and plot</span></span>
<span id="cb151-26"><a href="4.3-gaussian-model-of-height.html#cb151-26" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb151-27"><a href="4.3-gaussian-model-of-height.html#cb151-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-28"><a href="4.3-gaussian-model-of-height.html#cb151-28" aria-hidden="true" tabindex="-1"></a>d_grid_samples <span class="ot">&lt;-</span> </span>
<span id="cb151-29"><a href="4.3-gaussian-model-of-height.html#cb151-29" aria-hidden="true" tabindex="-1"></a>  d_grid <span class="sc">%&gt;%</span> </span>
<span id="cb151-30"><a href="4.3-gaussian-model-of-height.html#cb151-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="at">size =</span> <span class="fl">1e4</span>, <span class="at">replace =</span> T, <span class="at">weight =</span> probability)</span>
<span id="cb151-31"><a href="4.3-gaussian-model-of-height.html#cb151-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-32"><a href="4.3-gaussian-model-of-height.html#cb151-32" aria-hidden="true" tabindex="-1"></a>d_grid_samples <span class="sc">%&gt;%</span> </span>
<span id="cb151-33"><a href="4.3-gaussian-model-of-height.html#cb151-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mu, <span class="at">y =</span> sigma)) <span class="sc">+</span> </span>
<span id="cb151-34"><a href="4.3-gaussian-model-of-height.html#cb151-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> .<span class="dv">9</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb151-35"><a href="4.3-gaussian-model-of-height.html#cb151-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(mu[samples]),</span>
<span id="cb151-36"><a href="4.3-gaussian-model-of-height.html#cb151-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(sigma[samples])) <span class="sc">+</span></span>
<span id="cb151-37"><a href="4.3-gaussian-model-of-height.html#cb151-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="04_geocentric_models_files/figure-html/4.24-1.png" width="672" /></p>
<p>And the updated densities..</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="4.3-gaussian-model-of-height.html#cb152-1" aria-hidden="true" tabindex="-1"></a>d_grid_samples <span class="sc">%&gt;%</span> </span>
<span id="cb152-2"><a href="4.3-gaussian-model-of-height.html#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(mu<span class="sc">:</span>sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb152-3"><a href="4.3-gaussian-model-of-height.html#cb152-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-4"><a href="4.3-gaussian-model-of-height.html#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span> </span>
<span id="cb152-5"><a href="4.3-gaussian-model-of-height.html#cb152-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;grey33&quot;</span>, <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb152-6"><a href="4.3-gaussian-model-of-height.html#cb152-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb152-7"><a href="4.3-gaussian-model-of-height.html#cb152-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb152-8"><a href="4.3-gaussian-model-of-height.html#cb152-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb152-9"><a href="4.3-gaussian-model-of-height.html#cb152-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">labeller =</span> label_parsed)</span></code></pre></div>
<p><img src="04_geocentric_models_files/figure-html/4.25-1.png" width="672" /></p>
<p>Now you can see the posterior for <span class="math inline">\(\sigma\)</span> is not Gaussian, but as a long tail towards higher values.</p>
<p><strong><em>4.3.5 Finding the posterior distribution with <code>quap</code></em></strong></p>
<div class="figure">
<img src="slides/L03/32.png" alt="Grid approximation is useful for teaching, but now we'll do a fancy approximation of it so we can go to higher dimensions. THat approximation asserts that the distribution is normal for every parameter. But once you get to generalised linear models it's a bad approximation. How does this work? You need two numbers: mean and SD. For multi-dimensional Gaussians, you also need a covariance matrix for the parameters. How do you do it? You climb the hill. It doesn't know what the hill is, but it knows what is up and down. So it tries to find the peak. When it gets to the peak, it needs to measure the curvature of the peak. And that's all it needs to approxi ate the curve. Often called the LaPlace approximation." width="80%" />
<p class="caption marginnote shownote">
Grid approximation is useful for teaching, but now we’ll do a fancy approximation of it so we can go to higher dimensions. THat approximation asserts that the distribution is normal for every parameter. But once you get to generalised linear models it’s a bad approximation. How does this work? You need two numbers: mean and SD. For multi-dimensional Gaussians, you also need a covariance matrix for the parameters. How do you do it? You climb the hill. It doesn’t know what the hill is, but it knows what is up and down. So it tries to find the peak. When it gets to the peak, it needs to measure the curvature of the peak. And that’s all it needs to approxi ate the curve. Often called the LaPlace approximation.
</p>
</div>
<p><img src="slides/L03/33.png" width="80%" /></p>
<p><code>quap</code> works by making the formula lists. Typically there’s some abbreviated forms. You’ll have to write how every parameter multiplies every variable.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="4.3-gaussian-model-of-height.html#cb153-1" aria-hidden="true" tabindex="-1"></a>b4<span class="fl">.1</span> <span class="ot">&lt;-</span> </span>
<span id="cb153-2"><a href="4.3-gaussian-model-of-height.html#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d2, </span>
<span id="cb153-3"><a href="4.3-gaussian-model-of-height.html#cb153-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb153-4"><a href="4.3-gaussian-model-of-height.html#cb153-4" aria-hidden="true" tabindex="-1"></a>      height <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb153-5"><a href="4.3-gaussian-model-of-height.html#cb153-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">178</span>, <span class="dv">20</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb153-6"><a href="4.3-gaussian-model-of-height.html#cb153-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">uniform</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb153-7"><a href="4.3-gaussian-model-of-height.html#cb153-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">31000</span>, <span class="at">warmup =</span> <span class="dv">30000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb153-8"><a href="4.3-gaussian-model-of-height.html#cb153-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">4</span>,</span>
<span id="cb153-9"><a href="4.3-gaussian-model-of-height.html#cb153-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b04.01&quot;</span>)</span>
<span id="cb153-10"><a href="4.3-gaussian-model-of-height.html#cb153-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-11"><a href="4.3-gaussian-model-of-height.html#cb153-11" aria-hidden="true" tabindex="-1"></a><span class="co"># HMC tends to work better when you default to an exponential or half Cauchy for sigma</span></span>
<span id="cb153-12"><a href="4.3-gaussian-model-of-height.html#cb153-12" aria-hidden="true" tabindex="-1"></a>b4<span class="fl">.1</span>_hc <span class="ot">&lt;-</span> </span>
<span id="cb153-13"><a href="4.3-gaussian-model-of-height.html#cb153-13" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span>(<span class="at">data =</span> d2, </span>
<span id="cb153-14"><a href="4.3-gaussian-model-of-height.html#cb153-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> gaussian,</span>
<span id="cb153-15"><a href="4.3-gaussian-model-of-height.html#cb153-15" aria-hidden="true" tabindex="-1"></a>            height <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb153-16"><a href="4.3-gaussian-model-of-height.html#cb153-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">prior =</span> <span class="fu">c</span>(brms<span class="sc">::</span><span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">178</span>, <span class="dv">20</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb153-17"><a href="4.3-gaussian-model-of-height.html#cb153-17" aria-hidden="true" tabindex="-1"></a>                      <span class="co"># the magic lives here</span></span>
<span id="cb153-18"><a href="4.3-gaussian-model-of-height.html#cb153-18" aria-hidden="true" tabindex="-1"></a>                      brms<span class="sc">::</span><span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb153-19"><a href="4.3-gaussian-model-of-height.html#cb153-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb153-20"><a href="4.3-gaussian-model-of-height.html#cb153-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">seed =</span> <span class="dv">4</span>,</span>
<span id="cb153-21"><a href="4.3-gaussian-model-of-height.html#cb153-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">file =</span> <span class="st">&quot;fits/b04.01_hc&quot;</span>)</span></code></pre></div>
<p>Plug in the parameters and plug it into <code>quap</code>.</p>
<p><img src="slides/L03/34.png" width="80%" /></p>
<p><code>quap</code> translates it into a statement about a log probability of the combinations of data, then passes it to the hill-finding algorithm built into R called <code>optim</code>, which passes it back as a list of means and a covariance matrix, which is sufficient to create a posterior distribution.</p>
<div class="figure">
<img src="slides/L03/35.png" alt="`precis` is minimalistic compared to `summary`. Provides the 89% compatibility intervals." width="80%" />
<p class="caption marginnote shownote">
<code>precis</code> is minimalistic compared to <code>summary</code>. Provides the 89% compatibility intervals.
</p>
</div>
<p>These numbers provide Gaussian approximations for each parameter’s <em>marginal</em> distribution, meaning the plausibility of each value of <span class="math inline">\(\mu\)</span> after averaging over the plausibilities of each value of <span class="math inline">\(\sigma\)</span>.</p>
<p><code>quap</code> estimates the posterior by climbing it like a hill. To do this, it has to start climbing someplace, at some combination of parameter values. But it’s possible to specify a starting value</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="4.3-gaussian-model-of-height.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(b4<span class="fl">.1</span>_hc)</span></code></pre></div>
<p><img src="04_geocentric_models_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>Get the model summary:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="4.3-gaussian-model-of-height.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b4<span class="fl">.1</span>_hc)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: height ~ 1 
##    Data: d2 (Number of observations: 352) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept   154.61      0.41   153.81   155.42 1.00     3833     2967
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     7.74      0.29     7.20     8.35 1.00     3511     2853
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>If you want the 89% intervals like <code>rethinking</code>:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="4.3-gaussian-model-of-height.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(b4<span class="fl">.1</span>_hc, <span class="at">prob =</span> .<span class="dv">89</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: height ~ 1 
##    Data: d2 (Number of observations: 352) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-89% CI u-89% CI Rhat Bulk_ESS Tail_ESS
## Intercept   154.61      0.41   153.96   155.27 1.00     3833     2967
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-89% CI u-89% CI Rhat Bulk_ESS Tail_ESS
## sigma     7.74      0.29     7.29     8.23 1.00     3511     2853
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Let’s splice in a more informative prior for <span class="math inline">\(\mu\)</span> so you can see the effect.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="4.3-gaussian-model-of-height.html#cb159-1" aria-hidden="true" tabindex="-1"></a>b4<span class="fl">.2</span> <span class="ot">&lt;-</span> </span>
<span id="cb159-2"><a href="4.3-gaussian-model-of-height.html#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d2, </span>
<span id="cb159-3"><a href="4.3-gaussian-model-of-height.html#cb159-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb159-4"><a href="4.3-gaussian-model-of-height.html#cb159-4" aria-hidden="true" tabindex="-1"></a>      height <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb159-5"><a href="4.3-gaussian-model-of-height.html#cb159-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">178</span>, <span class="fl">0.1</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb159-6"><a href="4.3-gaussian-model-of-height.html#cb159-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">uniform</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb159-7"><a href="4.3-gaussian-model-of-height.html#cb159-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb159-8"><a href="4.3-gaussian-model-of-height.html#cb159-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">4</span>,</span>
<span id="cb159-9"><a href="4.3-gaussian-model-of-height.html#cb159-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b04.02&quot;</span>)</span>
<span id="cb159-10"><a href="4.3-gaussian-model-of-height.html#cb159-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-11"><a href="4.3-gaussian-model-of-height.html#cb159-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(b4<span class="fl">.2</span>)</span></code></pre></div>
<p><img src="04_geocentric_models_files/figure-html/4.31-1.png" width="672" /></p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="4.3-gaussian-model-of-height.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(b4<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: height ~ 1 
##    Data: d2 (Number of observations: 352) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept   177.86      0.10   177.66   178.06 1.00     3467     2724
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    24.59      0.91    22.95    26.54 1.01      483      422
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Compare the two:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="4.3-gaussian-model-of-height.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">summary</span>(b4<span class="fl">.1</span>_hc)<span class="sc">$</span>fixed,</span>
<span id="cb162-2"><a href="4.3-gaussian-model-of-height.html#cb162-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summary</span>(b4<span class="fl">.2</span>)<span class="sc">$</span>fixed)</span></code></pre></div>
<pre><code>##           Estimate Est.Error l-95% CI u-95% CI     Rhat Bulk_ESS Tail_ESS
## Intercept 154.6133 0.4100253 153.8146 155.4213 1.000225     3833     2967
## Intercept 177.8637 0.1014405 177.6609 178.0614 1.000384     3467     2724</code></pre>
<p><strong><em>4.3.6 Sampling from a <del><code>quap</code></del> <code>brm()</code> fit</em></strong></p>
<p>To this the matrix of variances and covariances among all paris of parameters:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="4.3-gaussian-model-of-height.html#cb164-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">posterior_samples</span>(b4<span class="fl">.1</span>_hc) <span class="sc">%&gt;%</span> </span>
<span id="cb164-2"><a href="4.3-gaussian-model-of-height.html#cb164-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(b_Intercept, sigma, lp__)</span>
<span id="cb164-3"><a href="4.3-gaussian-model-of-height.html#cb164-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-4"><a href="4.3-gaussian-model-of-height.html#cb164-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(post)</span></code></pre></div>
<pre><code>##   b_Intercept    sigma      lp__
## 1    154.2645 7.992651 -1227.255
## 2    154.6744 7.427472 -1227.075
## 3    154.7472 7.410110 -1227.193
## 4    154.7948 8.470115 -1229.452
## 5    154.2154 7.940177 -1227.219
## 6    154.7131 7.744806 -1226.553</code></pre>
<p>This is a <strong>Variant-covariance Matrix</strong>. It is the multi-dimensional glue of a quadratic approximation, because it tells us how each parameter relates to every other parameter in the posterior distribution.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="4.3-gaussian-model-of-height.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NOw `select()` the columns and feed them into `cov()`</span></span>
<span id="cb166-2"><a href="4.3-gaussian-model-of-height.html#cb166-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(post, b_Intercept<span class="sc">:</span>sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb166-3"><a href="4.3-gaussian-model-of-height.html#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cov</span>()</span></code></pre></div>
<pre><code>##              b_Intercept        sigma
## b_Intercept  0.168120762 -0.005250413
## sigma       -0.005250413  0.086979181</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="4.3-gaussian-model-of-height.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># variances</span></span>
<span id="cb168-2"><a href="4.3-gaussian-model-of-height.html#cb168-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(post, b_Intercept<span class="sc">:</span>sigma) <span class="sc">%&gt;%</span></span>
<span id="cb168-3"><a href="4.3-gaussian-model-of-height.html#cb168-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cov</span>() <span class="sc">%&gt;%</span></span>
<span id="cb168-4"><a href="4.3-gaussian-model-of-height.html#cb168-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diag</span>()</span></code></pre></div>
<pre><code>## b_Intercept       sigma 
##  0.16812076  0.08697918</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="4.3-gaussian-model-of-height.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation</span></span>
<span id="cb170-2"><a href="4.3-gaussian-model-of-height.html#cb170-2" aria-hidden="true" tabindex="-1"></a>post <span class="sc">%&gt;%</span></span>
<span id="cb170-3"><a href="4.3-gaussian-model-of-height.html#cb170-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(b_Intercept, sigma) <span class="sc">%&gt;%</span></span>
<span id="cb170-4"><a href="4.3-gaussian-model-of-height.html#cb170-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>()</span></code></pre></div>
<pre><code>##             b_Intercept       sigma
## b_Intercept  1.00000000 -0.04341854
## sigma       -0.04341854  1.00000000</code></pre>
<p><img src="slides/L03/36.png" width="80%" /></p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="4.3-gaussian-model-of-height.html#cb172-1" aria-hidden="true" tabindex="-1"></a>post <span class="sc">%&gt;%</span></span>
<span id="cb172-2"><a href="4.3-gaussian-model-of-height.html#cb172-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>lp__) <span class="sc">%&gt;%</span> </span>
<span id="cb172-3"><a href="4.3-gaussian-model-of-height.html#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb172-4"><a href="4.3-gaussian-model-of-height.html#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value),</span>
<span id="cb172-5"><a href="4.3-gaussian-model-of-height.html#cb172-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd   =</span> <span class="fu">sd</span>(value),</span>
<span id="cb172-6"><a href="4.3-gaussian-model-of-height.html#cb172-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">2.5%</span><span class="st">`</span>  <span class="ot">=</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> .<span class="dv">025</span>),</span>
<span id="cb172-7"><a href="4.3-gaussian-model-of-height.html#cb172-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">97.5%</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> .<span class="dv">975</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb172-8"><a href="4.3-gaussian-model-of-height.html#cb172-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb172-9"><a href="4.3-gaussian-model-of-height.html#cb172-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">histospark =</span> <span class="fu">c</span>(<span class="fu">histospark</span>(post<span class="sc">$</span>b_Intercept), <span class="fu">histospark</span>(post<span class="sc">$</span>sigma)))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   name          mean    sd `2.5%` `97.5%` histospark 
##   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;      
## 1 b_Intercept 155.    0.41  154.   155.   ▁▁▅▇▂▁▁    
## 2 sigma         7.74  0.29    7.2    8.35 ▁▁▂▅▇▇▃▁▁▁▁</code></pre>
<div class="figure">
<img src="slides/L03/37.png" alt="To find out what it means, you draw some lines. I think of this tool as a scaffold so you can learn how to do modelling. But after you can use packages that use abbreviations. But it's important to learn how to build them. You'll come to appreciate how explicit it is. " width="80%" />
<p class="caption marginnote shownote">
To find out what it means, you draw some lines. I think of this tool as a scaffold so you can learn how to do modelling. But after you can use packages that use abbreviations. But it’s important to learn how to build them. You’ll come to appreciate how explicit it is.
</p>
</div>
<p>You want to graduate beyond <code>quap</code> because for generalised linear modelling it becomes dangerous.</p>
</div>
<p style="text-align: center;">
<a href="4.2-a-language-for-describing-models.html"><button class="btn btn-default">Previous</button></a>
<a href="4.4-linear-prediction.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
