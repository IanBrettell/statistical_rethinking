<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="14.2 Missing data | Notes for Statistical Rethinking 2nd ed. by Richard McElreath" />
<meta property="og:type" content="book" />






<meta name="date" content="2021-12-04" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="14.2 Missing data | Notes for Statistical Rethinking 2nd ed. by Richard McElreath">

<title>14.2 Missing data | Notes for Statistical Rethinking 2nd ed. by Richard McElreath</title>

<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#index">Index</a></li>
<li><a href="1-the-golem-of-prague.html#the-golem-of-prague"><span class="toc-section-number">1</span> The Golem of Prague</a></li>
<li class="has-sub"><a href="2-small-worlds-and-large-worlds.html#small-worlds-and-large-worlds"><span class="toc-section-number">2</span> Small Worlds and Large Worlds</a>
<ul>
<li><a href="2.1-the-garden-of-forking-data.html#the-garden-of-forking-data"><span class="toc-section-number">2.1</span> The garden of forking data</a></li>
<li><a href="2.2-building-a-model.html#building-a-model"><span class="toc-section-number">2.2</span> Building a model</a></li>
<li><a href="2.3-components-of-the-model.html#components-of-the-model"><span class="toc-section-number">2.3</span> Components of the model</a></li>
<li class="has-sub"><a href="2.4-making-the-model-go.html#making-the-model-go"><span class="toc-section-number">2.4</span> Making the model go</a>
<ul>
<li><a href="2.4-making-the-model-go.html#markov-chain-monte-carlo"><span class="toc-section-number">2.4.1</span> Markov chain Monte Carlo</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="3-sampling-from-the-imaginary.html#sampling-from-the-imaginary"><span class="toc-section-number">3</span> Sampling from the Imaginary</a>
<ul>
<li><a href="3.1-sampling-from-a-grid-approximate-posterior.html#sampling-from-a-grid-approximate-posterior"><span class="toc-section-number">3.1</span> Sampling from a grid-approximate posterior</a></li>
<li><a href="3.2-sampling-to-summarize.html#sampling-to-summarize"><span class="toc-section-number">3.2</span> Sampling to summarize</a></li>
<li><a href="3.3-sampling-to-simulate-prediction.html#sampling-to-simulate-prediction"><span class="toc-section-number">3.3</span> Sampling to simulate prediction</a></li>
<li><a href="3.4-lets-practice-with-brms.html#lets-practice-with-brms"><span class="toc-section-number">3.4</span> Let’s practice with brms</a></li>
<li><a href="practice.html#practice">Practice</a></li>
<li><a href="homework-week-1.html#homework-week-1">Homework: week 1</a></li>
</ul></li>
<li class="has-sub"><a href="4-geocentric-models.html#geocentric-models"><span class="toc-section-number">4</span> Geocentric Models</a>
<ul>
<li><a href="4.1-why-normal-distributions-are-normal.html#why-normal-distributions-are-normal"><span class="toc-section-number">4.1</span> Why normal distributions are normal</a></li>
<li><a href="4.2-a-language-for-describing-models.html#a-language-for-describing-models"><span class="toc-section-number">4.2</span> A language for describing models</a></li>
<li><a href="4.3-gaussian-model-of-height.html#gaussian-model-of-height"><span class="toc-section-number">4.3</span> Gaussian model of height</a></li>
<li><a href="4.4-linear-prediction.html#linear-prediction"><span class="toc-section-number">4.4</span> Linear prediction</a></li>
<li><a href="4.5-curves-from-lines.html#curves-from-lines"><span class="toc-section-number">4.5</span> Curves from lines</a></li>
<li><a href="4.6-practice-1.html#practice-1"><span class="toc-section-number">4.6</span> Practice</a></li>
</ul></li>
<li class="has-sub"><a href="5-the-many-variables-the-spurious-waffles.html#the-many-variables-the-spurious-waffles"><span class="toc-section-number">5</span> The Many Variables &amp; The Spurious Waffles</a>
<ul>
<li><a href="5.1-spurious-association.html#spurious-association"><span class="toc-section-number">5.1</span> Spurious association</a></li>
<li><a href="5.2-masked-relationship.html#masked-relationship"><span class="toc-section-number">5.2</span> Masked relationship</a></li>
<li><a href="5.3-categorical-variables.html#categorical-variables"><span class="toc-section-number">5.3</span> Categorical variables</a></li>
<li><a href="5.4-practice-2.html#practice-2"><span class="toc-section-number">5.4</span> Practice</a></li>
</ul></li>
<li class="has-sub"><a href="6-the-haunted-dag-the-causal-terror.html#the-haunted-dag-the-causal-terror"><span class="toc-section-number">6</span> The Haunted DAG &amp; The Causal Terror</a>
<ul>
<li><a href="6.1-multicollinearity.html#multicollinearity"><span class="toc-section-number">6.1</span> Multicollinearity</a></li>
<li><a href="6.2-post-treatment-bias.html#post-treatment-bias"><span class="toc-section-number">6.2</span> Post-treatment bias</a></li>
<li><a href="6.3-collider-bias.html#collider-bias"><span class="toc-section-number">6.3</span> Collider bias</a></li>
<li><a href="6.4-confronting-confounding.html#confronting-confounding"><span class="toc-section-number">6.4</span> Confronting confounding</a></li>
<li><a href="6.5-summary.html#summary"><span class="toc-section-number">6.5</span> Summary</a></li>
<li><a href="6.6-practice-3.html#practice-3"><span class="toc-section-number">6.6</span> Practice</a></li>
</ul></li>
<li class="has-sub"><a href="7-ulysses-compass.html#ulysses-compass"><span class="toc-section-number">7</span> Ulysses’ Compass</a>
<ul>
<li><a href="7.1-the-problem-with-parameters.html#the-problem-with-parameters"><span class="toc-section-number">7.1</span> The problem with parameters</a></li>
<li><a href="7.2-entropy-and-accuracy.html#entropy-and-accuracy"><span class="toc-section-number">7.2</span> Entropy and accuracy</a></li>
<li><a href="7.3-golem-taming-regularization.html#golem-taming-regularization"><span class="toc-section-number">7.3</span> Golem taming: regularization</a></li>
<li><a href="7.4-predicting-predictive-accuracy.html#predicting-predictive-accuracy"><span class="toc-section-number">7.4</span> Predicting predictive accuracy</a></li>
<li><a href="7.5-model-comparison.html#model-comparison"><span class="toc-section-number">7.5</span> Model comparison</a></li>
<li><a href="7.6-practice-4.html#practice-4"><span class="toc-section-number">7.6</span> Practice</a></li>
</ul></li>
<li class="has-sub"><a href="8-conditional-manatees.html#conditional-manatees"><span class="toc-section-number">8</span> Conditional Manatees</a>
<ul>
<li><a href="8.1-building-an-interaction.html#building-an-interaction"><span class="toc-section-number">8.1</span> Building an interaction</a></li>
<li><a href="8.2-symmetry-of-interactions.html#symmetry-of-interactions"><span class="toc-section-number">8.2</span> Symmetry of interactions</a></li>
<li><a href="8.3-continuous-interactions.html#continuous-interactions"><span class="toc-section-number">8.3</span> Continuous interactions</a></li>
</ul></li>
<li class="has-sub"><a href="9-markov-chain-monte-carlo-1.html#markov-chain-monte-carlo-1"><span class="toc-section-number">9</span> Markov Chain Monte Carlo</a>
<ul>
<li><a href="9.1-good-king-markov-and-his-island-kingdom.html#good-king-markov-and-his-island-kingdom"><span class="toc-section-number">9.1</span> Good King Markov and his island kingdom</a></li>
<li><a href="9.2-metropolis-algorithm.html#metropolis-algorithm"><span class="toc-section-number">9.2</span> Metropolis algorithm</a></li>
<li><a href="9.3-hamiltonian-monte-carlo.html#hamiltonian-monte-carlo"><span class="toc-section-number">9.3</span> Hamiltonian Monte Carlo</a></li>
<li><a href="9.4-easy-hmc-ulam.html#easy-hmc-ulam"><span class="toc-section-number">9.4</span> Easy HMC: <code>ulam</code></a></li>
<li><a href="9.5-care-and-feeding-of-your-markov-chain.html#care-and-feeding-of-your-markov-chain"><span class="toc-section-number">9.5</span> Care and feeding of your Markov chain</a></li>
</ul></li>
<li class="has-sub"><a href="10-big-entropy-and-the-generalized-linear-model.html#big-entropy-and-the-generalized-linear-model"><span class="toc-section-number">10</span> Big Entropy and the Generalized Linear Model</a>
<ul>
<li><a href="10.1-maximum-entropy.html#maximum-entropy"><span class="toc-section-number">10.1</span> Maximum entropy</a></li>
<li><a href="10.2-generalized-linear-models.html#generalized-linear-models"><span class="toc-section-number">10.2</span> Generalized linear models</a></li>
</ul></li>
<li class="has-sub"><a href="11-god-spiked-the-integers.html#god-spiked-the-integers"><span class="toc-section-number">11</span> God Spiked the Integers</a>
<ul>
<li><a href="11.1-binomial-regression.html#binomial-regression"><span class="toc-section-number">11.1</span> Binomial regression</a></li>
<li><a href="11.2-poisson-regression.html#poisson-regression"><span class="toc-section-number">11.2</span> Poisson regression</a></li>
<li><a href="11.3-multinomial-and-categorical-models.html#multinomial-and-categorical-models"><span class="toc-section-number">11.3</span> Multinomial and categorical models</a></li>
</ul></li>
<li class="has-sub"><a href="12-models-with-memory.html#models-with-memory"><span class="toc-section-number">12</span> Models With Memory</a>
<ul>
<li><a href="12.1-example-multilevel-tadpoles.html#example-multilevel-tadpoles"><span class="toc-section-number">12.1</span> Example: Multilevel tadpoles</a></li>
<li><a href="12.2-varying-effects-and-the-underfittingoverfitting-trade-off.html#varying-effects-and-the-underfittingoverfitting-trade-off"><span class="toc-section-number">12.2</span> Varying effects and the underfitting/overfitting trade-off</a></li>
<li><a href="12.3-more-than-one-type-of-cluster.html#more-than-one-type-of-cluster"><span class="toc-section-number">12.3</span> More than one type of cluster</a></li>
<li><a href="12.4-divergent-transitions-and-non-centered-priors.html#divergent-transitions-and-non-centered-priors"><span class="toc-section-number">12.4</span> Divergent transitions and non-centered priors</a></li>
<li><a href="12.5-multilevel-posterior-predictions.html#multilevel-posterior-predictions"><span class="toc-section-number">12.5</span> Multilevel posterior predictions</a></li>
</ul></li>
<li class="has-sub"><a href="13-adventures-in-covariance.html#adventures-in-covariance"><span class="toc-section-number">13</span> Adventures in Covariance</a>
<ul>
<li><a href="13.1-varying-slopes-by-construction.html#varying-slopes-by-construction"><span class="toc-section-number">13.1</span> Varying slopes by construction</a></li>
<li><a href="13.2-advanced-varying-slopes.html#advanced-varying-slopes"><span class="toc-section-number">13.2</span> Advanced varying slopes</a></li>
<li><a href="13.3-instruments-and-causal-designs.html#instruments-and-causal-designs"><span class="toc-section-number">13.3</span> Instruments and causal designs</a></li>
<li><a href="13.4-social-relations-as-correlated-varying-effects.html#social-relations-as-correlated-varying-effects"><span class="toc-section-number">13.4</span> Social relations as correlated varying effects</a></li>
<li><a href="13.5-continuous-categories-and-the-gaussian-process.html#continuous-categories-and-the-gaussian-process"><span class="toc-section-number">13.5</span> Continuous categories and the Gaussian process</a></li>
<li><a href="13.6-bonus-multilevel-growth-models-and-the-melsm.html#bonus-multilevel-growth-models-and-the-melsm"><span class="toc-section-number">13.6</span> Bonus: Multilevel growth models and the MELSM</a></li>
</ul></li>
<li class="has-sub"><a href="14-missing-data-and-other-opportunities.html#missing-data-and-other-opportunities"><span class="toc-section-number">14</span> Missing Data and Other Opportunities</a>
<ul>
<li><a href="14.1-measurement-error.html#measurement-error"><span class="toc-section-number">14.1</span> Measurement error</a></li>
<li><a href="14.2-missing-data.html#missing-data"><span class="toc-section-number">14.2</span> Missing data</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="missing-data" class="section level2" number="14.2">
<h2><span class="header-section-number">14.2</span> Missing data</h2>
<div class="figure">
<img src="slides/L20/29.png" alt="Grown up measurement error. Mechanically similar but feels really different. You want to do something about missing data. Most of the standard regression tools will autoamtically remove missing cases. So all the variables are removed. This squanders information, but can also create confounds. There are ways to deal with this. So how to deal with it? Worst appraoch is to replace teh missing values with the mean of the column. Really bad idea because they model will intepret it as if you knew the value. Procedure called multiple imputation, whcih works really well. Frequentist way of doing what we're going to do. Unreasoanbly effective. Basically do the modle multiple times on samples on some stochastic model of the dataset. We're just going to go full-flavour Bayesian." width="80%" />
<p class="caption marginnote shownote">
Grown up measurement error. Mechanically similar but feels really different. You want to do something about missing data. Most of the standard regression tools will autoamtically remove missing cases. So all the variables are removed. This squanders information, but can also create confounds. There are ways to deal with this. So how to deal with it? Worst appraoch is to replace teh missing values with the mean of the column. Really bad idea because they model will intepret it as if you knew the value. Procedure called multiple imputation, whcih works really well. Frequentist way of doing what we’re going to do. Unreasoanbly effective. Basically do the modle multiple times on samples on some stochastic model of the dataset. We’re just going to go full-flavour Bayesian.
</p>
</div>
<p><strong><em>15.2.2. Imputing primates</em></strong></p>
<div class="figure">
<img src="slides/L20/30.png" alt="Let's talk about DAGs again. Deeply confusing, because the terminology is awful. Let's think about the primate milk data again. Interested in understanding why the energy content of milk varies so much. Is is related to the proportion of brain neocortex. U is the strong postive correlation between M and B, but we don't know what it is. Something going on here but we don't know what it is." width="80%" />
<p class="caption marginnote shownote">
Let’s talk about DAGs again. Deeply confusing, because the terminology is awful. Let’s think about the primate milk data again. Interested in understanding why the energy content of milk varies so much. Is is related to the proportion of brain neocortex. U is the strong postive correlation between M and B, but we don’t know what it is. Something going on here but we don’t know what it is.
</p>
</div>
<div class="figure">
<img src="slides/L20/31.png" alt="This taxonomy tells us what to do. Confusingly, MCAR is totally different to MAR. " width="80%" />
<p class="caption marginnote shownote">
This taxonomy tells us what to do. Confusingly, MCAR is totally different to MAR.
</p>
</div>
<div class="figure">
<img src="slides/L20/32.png" alt="MCAR. We're not going to get to see B, because it has missing values in it. Lot's of primates where they didn't measure percent neocortex. To get the gaps, we know it's partly caused by B, but it's also caused by the missingness process R. `R_B` creates missing values in `B`. " width="80%" />
<p class="caption marginnote shownote">
MCAR. We’re not going to get to see B, because it has missing values in it. Lot’s of primates where they didn’t measure percent neocortex. To get the gaps, we know it’s partly caused by B, but it’s also caused by the missingness process R. <code>R_B</code> creates missing values in <code>B</code>.
</p>
</div>
<div class="figure">
<img src="slides/L20/33.png" alt="We're going to condition on `B_obs`. Are there backdoors? The answer is no, but there are two paths. Direct and indirect. But the total causal effect can be estimated by simple regression with just `B_obs`. There's an indirect effect through M. But there's no back door. " width="80%" />
<p class="caption marginnote shownote">
We’re going to condition on <code>B_obs</code>. Are there backdoors? The answer is no, but there are two paths. Direct and indirect. But the total causal effect can be estimated by simple regression with just <code>B_obs</code>. There’s an indirect effect through M. But there’s no back door.
</p>
</div>
<div class="figure">
<img src="slides/L20/34.png" alt="There's no path that takes you through `R_B`. This means the missingness mechanism is ignorable, because it doesn't create any backdoor confound. So you don't need to know it. This is the benign case." width="80%" />
<p class="caption marginnote shownote">
There’s no path that takes you through <code>R_B</code>. This means the missingness mechanism is ignorable, because it doesn’t create any backdoor confound. So you don’t need to know it. This is the benign case.
</p>
</div>
<div class="figure">
<img src="slides/L20/35.png" alt="You don't have to condition on anything to keep your inference about K independent from the missingness mechanism." width="80%" />
<p class="caption marginnote shownote">
You don’t have to condition on anything to keep your inference about K independent from the missingness mechanism.
</p>
</div>
<div class="figure">
<img src="slides/L20/36.png" alt="The only way this could happen is if you had a random number generator deletes values from your dataset. I assert this is highly implausible in most research situations. " width="80%" />
<p class="caption marginnote shownote">
The only way this could happen is if you had a random number generator deletes values from your dataset. I assert this is highly implausible in most research situations.
</p>
</div>
<div class="figure">
<img src="slides/L20/37.png" alt="This is something else that could be going on. This will give us MAR. M is now entering/influencing R_B. Now the missingness mechanism depends on the body mass values. Large or small body masses are more likely to have missing body mass values. Different species are more or less attractive to study. That generates a pattern where some features are associated causally with the missingness. " width="80%" />
<p class="caption marginnote shownote">
This is something else that could be going on. This will give us MAR. M is now entering/influencing R_B. Now the missingness mechanism depends on the body mass values. Large or small body masses are more likely to have missing body mass values. Different species are more or less attractive to study. That generates a pattern where some features are associated causally with the missingness.
</p>
</div>
<div class="figure">
<img src="slides/L20/38.png" alt="As before, is there a backdoor path. Now because there's an arrow entering R_B.." width="80%" />
<p class="caption marginnote shownote">
As before, is there a backdoor path. Now because there’s an arrow entering R_B..
</p>
</div>
<div class="figure">
<img src="slides/L20/39.png" alt="You have a complete path. How to close the backdoor? Condition on M. Here you don't have to know the missingness mechanism, but do need to do imputation." width="80%" />
<p class="caption marginnote shownote">
You have a complete path. How to close the backdoor? Condition on M. Here you don’t have to know the missingness mechanism, but do need to do imputation.
</p>
</div>
<div class="figure">
<img src="slides/L20/40.png" alt="There's some variable in the graph we can condition on, and separate the two. This is a nice situation to be in, and probably the most common. Why need to impute? Because you'd be polluting the other variables with this missngness pattern, whcihc an create really strong biases." width="80%" />
<p class="caption marginnote shownote">
There’s some variable in the graph we can condition on, and separate the two. This is a nice situation to be in, and probably the most common. Why need to impute? Because you’d be polluting the other variables with this missngness pattern, whcihc an create really strong biases.
</p>
</div>
<div class="figure">
<img src="slides/L20/41.png" alt="Worst case. In this case, the most obvious way to get it is the variable itself causes the missingness. Certain values of neoxortex percent are more likely to go missing. How? Maybe species with low neocortex weren't measured." width="80%" />
<p class="caption marginnote shownote">
Worst case. In this case, the most obvious way to get it is the variable itself causes the missingness. Certain values of neoxortex percent are more likely to go missing. How? Maybe species with low neocortex weren’t measured.
</p>
</div>
<div class="figure">
<img src="slides/L20/42.png" alt="This is nasty because you get a backdoor you can't close. Your only hope is to model the missingness mechanism and thereby condition on it." width="80%" />
<p class="caption marginnote shownote">
This is nasty because you get a backdoor you can’t close. Your only hope is to model the missingness mechanism and thereby condition on it.
</p>
</div>
<div class="figure">
<img src="slides/L20/43.png" alt="The other way to get it would be to have a missingness variable. Here there's fork, like phylogeny. We like to study animals closer to us. That will influence neocortex percent, and also influence missingness." width="80%" />
<p class="caption marginnote shownote">
The other way to get it would be to have a missingness variable. Here there’s fork, like phylogeny. We like to study animals closer to us. That will influence neocortex percent, and also influence missingness.
</p>
</div>
<p><img src="slides/L20/44.png" width="80%" /></p>
<div class="figure">
<img src="slides/L20/45.png" alt="Imagine a DAG iwth four variables. R is nowD, a dog. In the first, the dog will eat any homework. In the middle, teh dog eats particular students' homework. The attribute could be attention span, as in they turn away and the dog eats it. Finally, the dog only eats bad homework. Or, more liekly, the stuent feeds it to the dog. But it depends ont he score ofthe homework. " width="80%" />
<p class="caption marginnote shownote">
Imagine a DAG iwth four variables. R is nowD, a dog. In the first, the dog will eat any homework. In the middle, teh dog eats particular students’ homework. The attribute could be attention span, as in they turn away and the dog eats it. Finally, the dog only eats bad homework. Or, more liekly, the stuent feeds it to the dog. But it depends ont he score ofthe homework.
</p>
</div>
<div class="figure">
<img src="slides/L20/46.png" alt="Let's go through the mechanics of this. " width="80%" />
<p class="caption marginnote shownote">
Let’s go through the mechanics of this.
</p>
</div>
<div class="sourceCode" id="cb1253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1253-1"><a href="14.2-missing-data.html#cb1253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(milk, <span class="at">package =</span> <span class="st">&quot;rethinking&quot;</span>)</span>
<span id="cb1253-2"><a href="14.2-missing-data.html#cb1253-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> milk</span>
<span id="cb1253-3"><a href="14.2-missing-data.html#cb1253-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(milk)</span>
<span id="cb1253-4"><a href="14.2-missing-data.html#cb1253-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1253-5"><a href="14.2-missing-data.html#cb1253-5" aria-hidden="true" tabindex="-1"></a><span class="co"># transform</span></span>
<span id="cb1253-6"><a href="14.2-missing-data.html#cb1253-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb1253-7"><a href="14.2-missing-data.html#cb1253-7" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb1253-8"><a href="14.2-missing-data.html#cb1253-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">neocortex.prop =</span> neocortex.perc <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb1253-9"><a href="14.2-missing-data.html#cb1253-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">logmass        =</span> <span class="fu">log</span>(mass)) <span class="sc">%&gt;%</span> </span>
<span id="cb1253-10"><a href="14.2-missing-data.html#cb1253-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">k =</span> (kcal.per.g <span class="sc">-</span> <span class="fu">mean</span>(kcal.per.g)) <span class="sc">/</span> <span class="fu">sd</span>(kcal.per.g),</span>
<span id="cb1253-11"><a href="14.2-missing-data.html#cb1253-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">b =</span> (neocortex.prop <span class="sc">-</span> <span class="fu">mean</span>(neocortex.prop, <span class="at">na.rm =</span> T)) <span class="sc">/</span> <span class="fu">sd</span>(neocortex.prop, <span class="at">na.rm =</span> T),</span>
<span id="cb1253-12"><a href="14.2-missing-data.html#cb1253-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">m =</span> (logmass <span class="sc">-</span> <span class="fu">mean</span>(logmass)) <span class="sc">/</span> <span class="fu">sd</span>(logmass))</span></code></pre></div>
<p>We’re missing 12 values from <code>neocortex.prop</code>:</p>
<div class="sourceCode" id="cb1254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1254-1"><a href="14.2-missing-data.html#cb1254-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb1254-2"><a href="14.2-missing-data.html#cb1254-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="fu">is.na</span>(neocortex.prop))</span></code></pre></div>
<pre><code>##   is.na(neocortex.prop)  n
## 1                 FALSE 17
## 2                  TRUE 12</code></pre>
<div class="figure">
<img src="slides/L20/47.png" alt="We'll replace the NAs with a parameter, and get posterior distributions for each of the missing values. " width="80%" />
<p class="caption marginnote shownote">
We’ll replace the NAs with a parameter, and get posterior distributions for each of the missing values.
</p>
</div>
<div class="figure">
<img src="slides/L20/48.png" alt="Now they get assigned a parameter. They'll be imputed by the modeo." width="80%" />
<p class="caption marginnote shownote">
Now they get assigned a parameter. They’ll be imputed by the modeo.
</p>
</div>
<div class="figure">
<img src="slides/L20/49.png" alt="B is now a vector in which some values are observed, and toehrs are paratmets. We'll stick them in an ordianry regression modeo. But now we have a prior. When B is observed, it infomrs the parameters in side it. Those will be estimated from teh observed values." width="80%" />
<p class="caption marginnote shownote">
B is now a vector in which some values are observed, and toehrs are paratmets. We’ll stick them in an ordianry regression modeo. But now we have a prior. When B is observed, it infomrs the parameters in side it. Those will be estimated from teh observed values.
</p>
</div>
<p><img src="slides/L20/50.png" width="80%" /></p>
<p><img src="slides/L20/51.png" width="80%" /></p>
<div class="figure">
<img src="slides/L20/52.png" alt="Looks exavtly the same, but we add this prior. `ulam` automates this." width="80%" />
<p class="caption marginnote shownote">
Looks exavtly the same, but we add this prior. <code>ulam</code> automates this.
</p>
</div>
<p>When writing a multivariate model in brms, I find it easier to save the model code by itself and then insert it into the <code>brm()</code> function. Otherwise, things start to feel cluttered.</p>
<div class="sourceCode" id="cb1256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1256-1"><a href="14.2-missing-data.html#cb1256-1" aria-hidden="true" tabindex="-1"></a>b_model <span class="ot">&lt;-</span> </span>
<span id="cb1256-2"><a href="14.2-missing-data.html#cb1256-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here&#39;s the primary `k` model</span></span>
<span id="cb1256-3"><a href="14.2-missing-data.html#cb1256-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(k <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">mi</span>(b) <span class="sc">+</span> m) <span class="sc">+</span> </span>
<span id="cb1256-4"><a href="14.2-missing-data.html#cb1256-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here&#39;s the model for the missing `b` data </span></span>
<span id="cb1256-5"><a href="14.2-missing-data.html#cb1256-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(b <span class="sc">|</span> <span class="fu">mi</span>() <span class="sc">~</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb1256-6"><a href="14.2-missing-data.html#cb1256-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here we set the residual correlations for the two models to zero</span></span>
<span id="cb1256-7"><a href="14.2-missing-data.html#cb1256-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_rescor</span>(<span class="cn">FALSE</span>)</span></code></pre></div>
<p>Get a sense of how to specify the priors:</p>
<div class="sourceCode" id="cb1257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1257-1"><a href="14.2-missing-data.html#cb1257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(<span class="at">data =</span> d, </span>
<span id="cb1257-2"><a href="14.2-missing-data.html#cb1257-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">family =</span> gaussian,</span>
<span id="cb1257-3"><a href="14.2-missing-data.html#cb1257-3" aria-hidden="true" tabindex="-1"></a>          b_model)</span></code></pre></div>
<pre><code>##                    prior     class coef group resp dpar nlpar bound
##                   (flat)         b                                 
##                   (flat) Intercept                                 
##   student_t(3, 0.2, 2.5) Intercept               b                 
##     student_t(3, 0, 2.5)     sigma               b                 
##                   (flat)         b               k                 
##                   (flat)         b    m          k                 
##                   (flat)         b  mib          k                 
##  student_t(3, -0.3, 2.5) Intercept               k                 
##     student_t(3, 0, 2.5)     sigma               k                 
##        source
##       default
##       default
##       default
##       default
##  (vectorized)
##  (vectorized)
##  (vectorized)
##       default
##       default</code></pre>
<p>With the one-step Bayesian imputation procedure in <code>brms</code>, you might need to use the <code>resp</code> argument when specifying non-default priors. Now fit the model.</p>
<div class="sourceCode" id="cb1259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1259-1"><a href="14.2-missing-data.html#cb1259-1" aria-hidden="true" tabindex="-1"></a>b15<span class="fl">.5</span> <span class="ot">&lt;-</span> </span>
<span id="cb1259-2"><a href="14.2-missing-data.html#cb1259-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d, </span>
<span id="cb1259-3"><a href="14.2-missing-data.html#cb1259-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1259-4"><a href="14.2-missing-data.html#cb1259-4" aria-hidden="true" tabindex="-1"></a>      b_model,  <span class="co"># here we insert the model</span></span>
<span id="cb1259-5"><a href="14.2-missing-data.html#cb1259-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> k),</span>
<span id="cb1259-6"><a href="14.2-missing-data.html#cb1259-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> b),</span>
<span id="cb1259-7"><a href="14.2-missing-data.html#cb1259-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b,         <span class="at">resp =</span> k),</span>
<span id="cb1259-8"><a href="14.2-missing-data.html#cb1259-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma,     <span class="at">resp =</span> k),</span>
<span id="cb1259-9"><a href="14.2-missing-data.html#cb1259-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma,     <span class="at">resp =</span> b)),</span>
<span id="cb1259-10"><a href="14.2-missing-data.html#cb1259-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1259-11"><a href="14.2-missing-data.html#cb1259-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb1259-12"><a href="14.2-missing-data.html#cb1259-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b15.05&quot;</span>)</span></code></pre></div>
<p><code>print()</code> only gives us part of the picture:</p>
<div class="sourceCode" id="cb1260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1260-1"><a href="14.2-missing-data.html#cb1260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b15<span class="fl">.5</span>)</span></code></pre></div>
<pre><code>##  Family: MV(gaussian, gaussian) 
##   Links: mu = identity; sigma = identity
##          mu = identity; sigma = identity 
## Formula: k ~ 1 + mi(b) + m 
##          b | mi() ~ 1 
##    Data: d (Number of observations: 29) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## k_Intercept     0.03      0.16    -0.31     0.33 1.00     3841     3213
## b_Intercept    -0.05      0.21    -0.46     0.37 1.00     3503     2561
## k_m            -0.55      0.21    -0.93    -0.13 1.00     1846     2497
## k_mib           0.50      0.24    -0.00     0.94 1.00     1553     2294
## 
## Family Specific Parameters: 
##         Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma_k     0.84      0.15     0.60     1.16 1.00     1951     2629
## sigma_b     1.01      0.17     0.74     1.43 1.00     2185     2374
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="figure">
<img src="slides/L20/53.png" alt=" You can see 12 imputes. What does this do to the slopes in the model?" width="80%" />
<p class="caption marginnote shownote">
You can see 12 imputes. What does this do to the slopes in the model?
</p>
</div>
<p>Get a summary of the imputed values:</p>
<div class="sourceCode" id="cb1262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1262-1"><a href="14.2-missing-data.html#cb1262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b15<span class="fl">.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1262-2"><a href="14.2-missing-data.html#cb1262-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##               Estimate Est.Error   Q2.5  Q97.5
## b_k_Intercept     0.03      0.16  -0.31   0.33
## b_b_Intercept    -0.05      0.21  -0.46   0.37
## b_k_m            -0.55      0.21  -0.93  -0.13
## bsp_k_mib         0.50      0.24   0.00   0.94
## sigma_k           0.84      0.15   0.60   1.16
## sigma_b           1.01      0.17   0.74   1.43
## Ymi_b[2]         -0.57      0.93  -2.37   1.28
## Ymi_b[3]         -0.69      0.92  -2.48   1.15
## Ymi_b[4]         -0.70      0.95  -2.52   1.29
## Ymi_b[5]         -0.31      0.91  -2.08   1.55
## Ymi_b[9]          0.47      0.91  -1.26   2.20
## Ymi_b[14]        -0.18      0.88  -1.86   1.57
## Ymi_b[15]         0.20      0.87  -1.53   1.92
## Ymi_b[17]         0.27      0.89  -1.55   2.05
## Ymi_b[19]         0.53      0.90  -1.33   2.23
## Ymi_b[21]        -0.46      0.91  -2.24   1.44
## Ymi_b[23]        -0.30      0.88  -2.05   1.41
## Ymi_b[26]         0.15      0.92  -1.67   1.93
## lp__            -81.18      4.00 -90.23 -74.73</code></pre>
<p>Plot to get a sense of what we’ve done:</p>
<div class="sourceCode" id="cb1264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1264-1"><a href="14.2-missing-data.html#cb1264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_samples</span>(b15<span class="fl">.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1264-2"><a href="14.2-missing-data.html#cb1264-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;Ymi_b&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1264-3"><a href="14.2-missing-data.html#cb1264-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">filter</span>(d, <span class="fu">is.na</span>(b)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(species)) <span class="sc">%&gt;%</span> </span>
<span id="cb1264-4"><a href="14.2-missing-data.html#cb1264-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb1264-5"><a href="14.2-missing-data.html#cb1264-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;species&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1264-6"><a href="14.2-missing-data.html#cb1264-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1264-7"><a href="14.2-missing-data.html#cb1264-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, </span>
<span id="cb1264-8"><a href="14.2-missing-data.html#cb1264-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="fu">reorder</span>(species, value))) <span class="sc">+</span></span>
<span id="cb1264-9"><a href="14.2-missing-data.html#cb1264-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slab</span>(<span class="at">fill =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">4</span>], </span>
<span id="cb1264-10"><a href="14.2-missing-data.html#cb1264-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">height =</span> <span class="fl">1.5</span>, <span class="at">slab_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">slab_size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1264-11"><a href="14.2-missing-data.html#cb1264-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;imputed values for b&quot;</span>,</span>
<span id="cb1264-12"><a href="14.2-missing-data.html#cb1264-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1264-13"><a href="14.2-missing-data.html#cb1264-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1264-14"><a href="14.2-missing-data.html#cb1264-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="15_missing_data_and_other_opportunities_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
<div class="sourceCode" id="cb1265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1265-1"><a href="14.2-missing-data.html#cb1265-1" aria-hidden="true" tabindex="-1"></a>b15<span class="fl">.6</span> <span class="ot">&lt;-</span> </span>
<span id="cb1265-2"><a href="14.2-missing-data.html#cb1265-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d, </span>
<span id="cb1265-3"><a href="14.2-missing-data.html#cb1265-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1265-4"><a href="14.2-missing-data.html#cb1265-4" aria-hidden="true" tabindex="-1"></a>      k <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> b <span class="sc">+</span> m,</span>
<span id="cb1265-5"><a href="14.2-missing-data.html#cb1265-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1265-6"><a href="14.2-missing-data.html#cb1265-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb1265-7"><a href="14.2-missing-data.html#cb1265-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb1265-8"><a href="14.2-missing-data.html#cb1265-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1265-9"><a href="14.2-missing-data.html#cb1265-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb1265-10"><a href="14.2-missing-data.html#cb1265-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b15.06&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="slides/L20/54.png" alt="Let's compare the same model. Now we can compare the slopes. Two predictors assocaited with the outcome variable in opposite directions. NOtice that the esimates have got more precise. They've also moved closer to the mean. " width="80%" />
<p class="caption marginnote shownote">
Let’s compare the same model. Now we can compare the slopes. Two predictors assocaited with the outcome variable in opposite directions. NOtice that the esimates have got more precise. They’ve also moved closer to the mean.
</p>
</div>
<div class="sourceCode" id="cb1266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1266-1"><a href="14.2-missing-data.html#cb1266-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb1266-2"><a href="14.2-missing-data.html#cb1266-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">fixef</span>(b15<span class="fl">.5</span>) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>),</span>
<span id="cb1266-3"><a href="14.2-missing-data.html#cb1266-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">fixef</span>(b15<span class="fl">.6</span>) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1266-4"><a href="14.2-missing-data.html#cb1266-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1266-5"><a href="14.2-missing-data.html#cb1266-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">str_c</span>(<span class="st">&quot;beta[&quot;</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), <span class="st">&quot;]&quot;</span>),</span>
<span id="cb1266-6"><a href="14.2-missing-data.html#cb1266-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">fit  =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;b15.5&quot;</span>, <span class="st">&quot;b15.6&quot;</span>), <span class="at">each =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1266-7"><a href="14.2-missing-data.html#cb1266-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1266-8"><a href="14.2-missing-data.html#cb1266-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb1266-9"><a href="14.2-missing-data.html#cb1266-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">y =</span> fit)) <span class="sc">+</span></span>
<span id="cb1266-10"><a href="14.2-missing-data.html#cb1266-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1266-11"><a href="14.2-missing-data.html#cb1266-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>)) <span class="sc">+</span></span>
<span id="cb1266-12"><a href="14.2-missing-data.html#cb1266-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;marginal posterior&quot;</span>,</span>
<span id="cb1266-13"><a href="14.2-missing-data.html#cb1266-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1266-14"><a href="14.2-missing-data.html#cb1266-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1266-15"><a href="14.2-missing-data.html#cb1266-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1266-16"><a href="14.2-missing-data.html#cb1266-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> term, <span class="at">labeller =</span> label_parsed, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="15_missing_data_and_other_opportunities_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
<div class="figure">
<img src="slides/L20/55.png" alt="We can plot the values up, but they'll have standard errors on them. Open circles is imputed. Posterior means follow the regression line. " width="80%" />
<p class="caption marginnote shownote">
We can plot the values up, but they’ll have standard errors on them. Open circles is imputed. Posterior means follow the regression line.
</p>
</div>
<div class="figure">
<img src="slides/L20/56.png" alt="The disappointing thing about this midel is that the relationship between the imputed values adn the predictor is 0, which is wrong. THat's because we dodn't tell it they're assocaited." width="80%" />
<p class="caption marginnote shownote">
The disappointing thing about this midel is that the relationship between the imputed values adn the predictor is 0, which is wrong. THat’s because we dodn’t tell it they’re assocaited.
</p>
</div>
<div class="sourceCode" id="cb1267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1267-1"><a href="14.2-missing-data.html#cb1267-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb1267-2"><a href="14.2-missing-data.html#cb1267-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1267-3"><a href="14.2-missing-data.html#cb1267-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1267-4"><a href="14.2-missing-data.html#cb1267-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb1267-5"><a href="14.2-missing-data.html#cb1267-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">posterior_summary</span>(b15<span class="fl">.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1267-6"><a href="14.2-missing-data.html#cb1267-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1267-7"><a href="14.2-missing-data.html#cb1267-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1267-8"><a href="14.2-missing-data.html#cb1267-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, <span class="st">&quot;Ymi&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1267-9"><a href="14.2-missing-data.html#cb1267-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">str_extract</span>(term, <span class="st">&quot;(</span><span class="sc">\\</span><span class="st">d)+&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">as.integer</span>()),</span>
<span id="cb1267-10"><a href="14.2-missing-data.html#cb1267-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">&quot;row&quot;</span></span>
<span id="cb1267-11"><a href="14.2-missing-data.html#cb1267-11" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb1267-12"><a href="14.2-missing-data.html#cb1267-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1267-13"><a href="14.2-missing-data.html#cb1267-13" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb1267-14"><a href="14.2-missing-data.html#cb1267-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(species, k<span class="sc">:</span>Q97<span class="fl">.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1267-15"><a href="14.2-missing-data.html#cb1267-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 29
## Columns: 10
## $ species   &lt;fct&gt; Eulemur fulvus, E macaco, E mongoz, E rubriventer, Lemur cat…
## $ k         &lt;dbl&gt; -0.9400408, -0.8161263, -1.1259125, -1.0019980, -0.2585112, …
## $ b         &lt;dbl&gt; -2.080196025, NA, NA, NA, NA, -0.508641289, -0.508641289, 0.…
## $ m         &lt;dbl&gt; -0.4558357, -0.4150024, -0.3071581, -0.5650254, -0.3874772, …
## $ row       &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1…
## $ term      &lt;chr&gt; NA, &quot;Ymi_b[2]&quot;, &quot;Ymi_b[3]&quot;, &quot;Ymi_b[4]&quot;, &quot;Ymi_b[5]&quot;, NA, NA, …
## $ Estimate  &lt;dbl&gt; NA, -0.5749477, -0.6944976, -0.6971893, -0.3109926, NA, NA, …
## $ Est.Error &lt;dbl&gt; NA, 0.9324091, 0.9228088, 0.9491488, 0.9071429, NA, NA, NA, …
## $ Q2.5      &lt;dbl&gt; NA, -2.368005, -2.483320, -2.519301, -2.078711, NA, NA, NA, …
## $ Q97.5     &lt;dbl&gt; NA, 1.277546, 1.151146, 1.289826, 1.545820, NA, NA, NA, 2.20…</code></pre>
<div class="sourceCode" id="cb1269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1269-1"><a href="14.2-missing-data.html#cb1269-1" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;D&quot;</span>)(<span class="dv">7</span>)[<span class="dv">4</span>]</span>
<span id="cb1269-2"><a href="14.2-missing-data.html#cb1269-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1269-3"><a href="14.2-missing-data.html#cb1269-3" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb1269-4"><a href="14.2-missing-data.html#cb1269-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1269-5"><a href="14.2-missing-data.html#cb1269-5" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1269-6"><a href="14.2-missing-data.html#cb1269-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> k)) <span class="sc">+</span></span>
<span id="cb1269-7"><a href="14.2-missing-data.html#cb1269-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> b),</span>
<span id="cb1269-8"><a href="14.2-missing-data.html#cb1269-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb1269-9"><a href="14.2-missing-data.html#cb1269-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb1269-10"><a href="14.2-missing-data.html#cb1269-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">fatten =</span> <span class="dv">8</span>, <span class="at">stroke =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1269-11"><a href="14.2-missing-data.html#cb1269-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;neocortex percent (std)&quot;</span>,</span>
<span id="cb1269-12"><a href="14.2-missing-data.html#cb1269-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;kcal milk (std)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1269-13"><a href="14.2-missing-data.html#cb1269-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(d<span class="sc">$</span>b, <span class="at">na.rm =</span> T))</span>
<span id="cb1269-14"><a href="14.2-missing-data.html#cb1269-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1269-15"><a href="14.2-missing-data.html#cb1269-15" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb1269-16"><a href="14.2-missing-data.html#cb1269-16" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1269-17"><a href="14.2-missing-data.html#cb1269-17" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1269-18"><a href="14.2-missing-data.html#cb1269-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> m)) <span class="sc">+</span></span>
<span id="cb1269-19"><a href="14.2-missing-data.html#cb1269-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> b),</span>
<span id="cb1269-20"><a href="14.2-missing-data.html#cb1269-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb1269-21"><a href="14.2-missing-data.html#cb1269-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb1269-22"><a href="14.2-missing-data.html#cb1269-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">fatten =</span> <span class="dv">8</span>, <span class="at">stroke =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1269-23"><a href="14.2-missing-data.html#cb1269-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;log body mass (std)&quot;</span>,</span>
<span id="cb1269-24"><a href="14.2-missing-data.html#cb1269-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;neocortex percent (std)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1269-25"><a href="14.2-missing-data.html#cb1269-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(d<span class="sc">$</span>b, <span class="at">na.rm =</span> T))</span>
<span id="cb1269-26"><a href="14.2-missing-data.html#cb1269-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1269-27"><a href="14.2-missing-data.html#cb1269-27" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot!</span></span>
<span id="cb1269-28"><a href="14.2-missing-data.html#cb1269-28" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 17 rows containing missing values (geom_pointrange).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 17 rows containing missing values (geom_pointrange).</code></pre>
<p><img src="15_missing_data_and_other_opportunities_files/figure-html/15.21%20b-1.png" width="672" /></p>
<p><img src="slides/L20/57.png" width="80%" /></p>
<div class="figure">
<img src="slides/L20/58.png" alt=" We fix this by making it a MVNormal. " width="80%" />
<p class="caption marginnote shownote">
We fix this by making it a MVNormal.
</p>
</div>
<div class="figure">
<img src="slides/L20/59.png" alt="Need to manually construct it. " width="80%" />
<p class="caption marginnote shownote">
Need to manually construct it.
</p>
</div>
<div class="sourceCode" id="cb1274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1274-1"><a href="14.2-missing-data.html#cb1274-1" aria-hidden="true" tabindex="-1"></a>b_model <span class="ot">&lt;-</span></span>
<span id="cb1274-2"><a href="14.2-missing-data.html#cb1274-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mvbf</span>(<span class="fu">bf</span>(k <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">mi</span>(b) <span class="sc">+</span> m), </span>
<span id="cb1274-3"><a href="14.2-missing-data.html#cb1274-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">bf</span>(b <span class="sc">|</span> <span class="fu">mi</span>() <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> m), </span>
<span id="cb1274-4"><a href="14.2-missing-data.html#cb1274-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">rescor =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1274-5"><a href="14.2-missing-data.html#cb1274-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1274-6"><a href="14.2-missing-data.html#cb1274-6" aria-hidden="true" tabindex="-1"></a>b15<span class="fl">.7</span> <span class="ot">&lt;-</span> </span>
<span id="cb1274-7"><a href="14.2-missing-data.html#cb1274-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d, </span>
<span id="cb1274-8"><a href="14.2-missing-data.html#cb1274-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1274-9"><a href="14.2-missing-data.html#cb1274-9" aria-hidden="true" tabindex="-1"></a>      b_model,</span>
<span id="cb1274-10"><a href="14.2-missing-data.html#cb1274-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> k),</span>
<span id="cb1274-11"><a href="14.2-missing-data.html#cb1274-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> b),</span>
<span id="cb1274-12"><a href="14.2-missing-data.html#cb1274-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b, <span class="at">resp =</span> k),</span>
<span id="cb1274-13"><a href="14.2-missing-data.html#cb1274-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b, <span class="at">resp =</span> b),</span>
<span id="cb1274-14"><a href="14.2-missing-data.html#cb1274-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma,     <span class="at">resp =</span> k),</span>
<span id="cb1274-15"><a href="14.2-missing-data.html#cb1274-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma,     <span class="at">resp =</span> b)),</span>
<span id="cb1274-16"><a href="14.2-missing-data.html#cb1274-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1274-17"><a href="14.2-missing-data.html#cb1274-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb1274-18"><a href="14.2-missing-data.html#cb1274-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b15.07&quot;</span>)</span></code></pre></div>
<p><img src="slides/L20/60.png" width="80%" /></p>
<div class="figure">
<img src="slides/L20/61.png" alt="Then happy days, you get even more precision." width="80%" />
<p class="caption marginnote shownote">
Then happy days, you get even more precision.
</p>
</div>
<p>Figure 15.6</p>
<div class="sourceCode" id="cb1275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1275-1"><a href="14.2-missing-data.html#cb1275-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb1275-2"><a href="14.2-missing-data.html#cb1275-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1275-3"><a href="14.2-missing-data.html#cb1275-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>(term<span class="sc">:</span>Q97<span class="fl">.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1275-4"><a href="14.2-missing-data.html#cb1275-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb1275-5"><a href="14.2-missing-data.html#cb1275-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">posterior_summary</span>(b15<span class="fl">.7</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1275-6"><a href="14.2-missing-data.html#cb1275-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1275-7"><a href="14.2-missing-data.html#cb1275-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1275-8"><a href="14.2-missing-data.html#cb1275-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, <span class="st">&quot;Ymi&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1275-9"><a href="14.2-missing-data.html#cb1275-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">str_extract</span>(term, <span class="st">&quot;(</span><span class="sc">\\</span><span class="st">d)+&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">as.integer</span>()),</span>
<span id="cb1275-10"><a href="14.2-missing-data.html#cb1275-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">&quot;row&quot;</span></span>
<span id="cb1275-11"><a href="14.2-missing-data.html#cb1275-11" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb1275-12"><a href="14.2-missing-data.html#cb1275-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1275-13"><a href="14.2-missing-data.html#cb1275-13" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb1275-14"><a href="14.2-missing-data.html#cb1275-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(species, k<span class="sc">:</span>Q97<span class="fl">.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1275-15"><a href="14.2-missing-data.html#cb1275-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 29
## Columns: 10
## $ species   &lt;fct&gt; Eulemur fulvus, E macaco, E mongoz, E rubriventer, Lemur cat…
## $ k         &lt;dbl&gt; -0.9400408, -0.8161263, -1.1259125, -1.0019980, -0.2585112, …
## $ b         &lt;dbl&gt; -2.080196025, NA, NA, NA, NA, -0.508641289, -0.508641289, 0.…
## $ m         &lt;dbl&gt; -0.4558357, -0.4150024, -0.3071581, -0.5650254, -0.3874772, …
## $ row       &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1…
## $ term      &lt;chr&gt; NA, &quot;Ymi_b[2]&quot;, &quot;Ymi_b[3]&quot;, &quot;Ymi_b[4]&quot;, &quot;Ymi_b[5]&quot;, NA, NA, …
## $ Estimate  &lt;dbl&gt; NA, -0.59675787, -0.64115105, -0.77746004, -0.39920411, NA, …
## $ Est.Error &lt;dbl&gt; NA, 0.6844536, 0.6769265, 0.6791844, 0.6573925, NA, NA, NA, …
## $ Q2.5      &lt;dbl&gt; NA, -1.9581199, -1.9841119, -2.1180278, -1.6832233, NA, NA, …
## $ Q97.5     &lt;dbl&gt; NA, 0.7762222, 0.7100079, 0.6052781, 0.9105329, NA, NA, NA, …</code></pre>
<div class="sourceCode" id="cb1277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1277-1"><a href="14.2-missing-data.html#cb1277-1" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;D&quot;</span>)(<span class="dv">7</span>)[<span class="dv">3</span>]</span>
<span id="cb1277-2"><a href="14.2-missing-data.html#cb1277-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1277-3"><a href="14.2-missing-data.html#cb1277-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1277-4"><a href="14.2-missing-data.html#cb1277-4" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1277-5"><a href="14.2-missing-data.html#cb1277-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> k)) <span class="sc">+</span></span>
<span id="cb1277-6"><a href="14.2-missing-data.html#cb1277-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> b),</span>
<span id="cb1277-7"><a href="14.2-missing-data.html#cb1277-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb1277-8"><a href="14.2-missing-data.html#cb1277-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb1277-9"><a href="14.2-missing-data.html#cb1277-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">fatten =</span> <span class="dv">8</span>, <span class="at">stroke =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1277-10"><a href="14.2-missing-data.html#cb1277-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;neocortex percent (std)&quot;</span>,</span>
<span id="cb1277-11"><a href="14.2-missing-data.html#cb1277-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;kcal milk (std)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1277-12"><a href="14.2-missing-data.html#cb1277-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(d<span class="sc">$</span>b, <span class="at">na.rm =</span> T))</span>
<span id="cb1277-13"><a href="14.2-missing-data.html#cb1277-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1277-14"><a href="14.2-missing-data.html#cb1277-14" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1277-15"><a href="14.2-missing-data.html#cb1277-15" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1277-16"><a href="14.2-missing-data.html#cb1277-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> m)) <span class="sc">+</span></span>
<span id="cb1277-17"><a href="14.2-missing-data.html#cb1277-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> b),</span>
<span id="cb1277-18"><a href="14.2-missing-data.html#cb1277-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb1277-19"><a href="14.2-missing-data.html#cb1277-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb1277-20"><a href="14.2-missing-data.html#cb1277-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">fatten =</span> <span class="dv">8</span>, <span class="at">stroke =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1277-21"><a href="14.2-missing-data.html#cb1277-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;log body mass (std)&quot;</span>,</span>
<span id="cb1277-22"><a href="14.2-missing-data.html#cb1277-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;neocortex percent (std)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1277-23"><a href="14.2-missing-data.html#cb1277-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(d<span class="sc">$</span>b, <span class="at">na.rm =</span> T))</span>
<span id="cb1277-24"><a href="14.2-missing-data.html#cb1277-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1277-25"><a href="14.2-missing-data.html#cb1277-25" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 17 rows containing missing values (geom_pointrange).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 17 rows containing missing values (geom_pointrange).</code></pre>
<p><img src="15_missing_data_and_other_opportunities_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<p><strong><em>15.2.3. Where is your god now?</em></strong></p>
<p>Sometimes there are no statistical solutions to scientific problems. But even then, careful statistical thinking can be useful because it will tell us that there is no statistical solution.</p>
<p>Some of the most successful religious traditions involve gods (and other supernatural entities) that enforce moral norms. For example, in the Abrahamic traditions, God punishes the wicked and rewards the just. Such gods might be called “moralizing gods.” In other traditions, gods behave in their own self-interest, with no interest in encouraging humans to cooperate with one another. Does such a difference in belief have any consequences for the society?</p>
<div class="sourceCode" id="cb1282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1282-1"><a href="14.2-missing-data.html#cb1282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Moralizing_gods, <span class="at">package =</span> <span class="st">&quot;rethinking&quot;</span>)</span>
<span id="cb1282-2"><a href="14.2-missing-data.html#cb1282-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> Moralizing_gods</span>
<span id="cb1282-3"><a href="14.2-missing-data.html#cb1282-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(Moralizing_gods)</span></code></pre></div>
<div class="sourceCode" id="cb1283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1283-1"><a href="14.2-missing-data.html#cb1283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(d)</span></code></pre></div>
<pre><code>## Rows: 864
## Columns: 5
## $ polity          &lt;fct&gt; Big Island Hawaii, Big Island Hawaii, Big Island Hawai…
## $ year            &lt;int&gt; 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, …
## $ population      &lt;dbl&gt; 3.729643, 3.729643, 3.598340, 4.026240, 4.311767, 4.20…
## $ moralizing_gods &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, 1, NA, NA, NA, NA, NA,…
## $ writing         &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</code></pre>
<p>Get a sense of how the values are distributed (Figure 15.7):</p>
<div class="sourceCode" id="cb1285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1285-1"><a href="14.2-missing-data.html#cb1285-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb1285-2"><a href="14.2-missing-data.html#cb1285-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mg =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(moralizing_gods), <span class="dv">2</span>, <span class="dv">1</span> <span class="sc">-</span> moralizing_gods),</span>
<span id="cb1285-3"><a href="14.2-missing-data.html#cb1285-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb1285-4"><a href="14.2-missing-data.html#cb1285-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;present&quot;</span>, <span class="st">&quot;absent&quot;</span>, <span class="st">&quot;unknown&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1285-5"><a href="14.2-missing-data.html#cb1285-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1285-6"><a href="14.2-missing-data.html#cb1285-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> population, <span class="at">color =</span> mg)) <span class="sc">+</span></span>
<span id="cb1285-7"><a href="14.2-missing-data.html#cb1285-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1285-8"><a href="14.2-missing-data.html#cb1285-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;Moralizing gods&quot;</span>, </span>
<span id="cb1285-9"><a href="14.2-missing-data.html#cb1285-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;D&quot;</span>)(<span class="dv">7</span>)[<span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">1</span>)]) <span class="sc">+</span></span>
<span id="cb1285-10"><a href="14.2-missing-data.html#cb1285-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&#39;&quot;This is a highly non-random missingness pattern&quot; (p. 514).&#39;</span>,</span>
<span id="cb1285-11"><a href="14.2-missing-data.html#cb1285-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Time (year)&quot;</span>,</span>
<span id="cb1285-12"><a href="14.2-missing-data.html#cb1285-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Population size (log)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1285-13"><a href="14.2-missing-data.html#cb1285-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">125</span>, .<span class="dv">67</span>))</span></code></pre></div>
<p><img src="15_missing_data_and_other_opportunities_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<div class="sourceCode" id="cb1286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1286-1"><a href="14.2-missing-data.html#cb1286-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb1286-2"><a href="14.2-missing-data.html#cb1286-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gods     =</span> moralizing_gods,</span>
<span id="cb1286-3"><a href="14.2-missing-data.html#cb1286-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">literacy =</span> writing) <span class="sc">%&gt;%</span> </span>
<span id="cb1286-4"><a href="14.2-missing-data.html#cb1286-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gods, literacy) <span class="sc">%&gt;%</span> </span>
<span id="cb1286-5"><a href="14.2-missing-data.html#cb1286-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>##   gods literacy   n          %
## 1    0        0  16  1.8518519
## 2    0        1   1  0.1157407
## 3    1        0   9  1.0416667
## 4    1        1 310 35.8796296
## 5   NA        0 442 51.1574074
## 6   NA        1  86  9.9537037</code></pre>
<div class="figure">
<img src="slides/L20/62.png" alt="This is a really big topic. One ofthe areas that is most important is with occupancy. Really missing data problems. There's a true occupancy but 0s are not trustworthy. They ahve a special preocess that comes from the detection process that you model." width="80%" />
<p class="caption marginnote shownote">
This is a really big topic. One ofthe areas that is most important is with occupancy. Really missing data problems. There’s a true occupancy but 0s are not trustworthy. They ahve a special preocess that comes from the detection process that you model.
</p>
</div>
<p><img src="slides/L20/63.png" width="80%" /></p>
<p><img src="slides/L20/64.png" width="80%" /></p>

</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="14.1-measurement-error.html"><button class="btn btn-default">Previous</button></a>
</p>
</div>
</div>



</body>
</html>
